
#The tricky bit is that you have to turn the faction into planets. But it's doable. And also the lack of commands
#regarding factions, so I can't directly check faction happiness.
#Trigger: Faction is large and unhappy. This would be tested via:
#pop_percentage = { percentage > 0.15 limit = { happiness < 40 member_of_faction = faction_X } }. So it would be 
#testing the symptom rather than the actual faction, which is not ideal but is the best I can do. Aside from that, 
#the empire has 5 planets, and at least one planet (not 'recently conquered') has more of their ethic than yours and
#30% is theirs (will be the first stronghold). There would be a relatively long mtth. 

#First event will be sort of 'warning signs' i.e. rumours of sedition but can't be proven, faction leader denies 
#anything. But planets with 4+ pops of the ethic get 'seditious talk' modifier, +20% ethics attraction.

#Second will be where planets with 30% or more of that ethic (and less of yours, also no revolt modifiers) become 
#'[ethic] strongholds'. They then get a whole lot more ethics attraction (+100?) (also possibly income fall as 
#withholding taxes). Planets fairly nearby will get modifiers attracting them to that ethic, but less. Planets with 
#3+ pops now get '[ethic] sympathies' and +50% or something attraction.

#This situation carries on for at least two years, and in this period any planet that goes above or below the 
#previously set-out thresholds gains or loses the modifiers. At this stage, one can avert the crisis by either 
#making the faction happy in some way (I could test whether the pops are happy as in the condition I said earlier) 
#or by successfully making them no longer have strongholds.

#After the two years, you will be told that a revolt is imminent if they are still upset and have enough strongholds 
#(this could be scaled by empire size, though it can only be done up to three planets). You will be given a direct 
#choice to shift ethics or risk the consequences. After that, at some point in the next year there will be a revolt 
#in all the 'ethic strongholds'. (Code will be based on the AI revolt, but without the need for a fight to the death).

#An addition would be the 'sympathies' planets: You'd be prompted to decide whether to exterminate, oppress or 
#tolerate them. Ethics determine whether you can do each of those. The trade-off is that if you tolerate and they 
#reach 'stronghold' level they can try to defect, whereas if you oppress they will get a modifier cutting attraction 
#to that ethic, but also lose happiness and have a chance to try and defect before you have managed to fully oppress 
#them. Exterminate is only possible for purifiers, then you just kill the pops in question. Though actually purifiers 
#should be allowed to do that way before. There should be some sort of costs to killing a large fragment of your 
#population, though.
#(Try purge = yes)

namespace = ccfaction

country_event = {
	id = ccfaction.1
	title = ccfaction.1.title
	picture = GFX_evt_smugglers_in_bar
	
	desc = {
		trigger = {
			hidden:event_target:cc_rebellious_faction = {
				switch = {
					trigger = is_pop_faction_type
					xenoist = { text = ccfaction.1.xenoist }
					supremacist = { text = ccfaction.1.supremacist }
					isolationist = { text = ccfaction.1.isolationist }
					progressive = { text = ccfaction.1.progressive }
					totalitarian = { text = ccfaction.1.totalitarian }
					imperialist = { text = ccfaction.1.imperialist }
					prosperity = { text = ccfaction.1.prosperity }
					traditionalist = { text = ccfaction.1.traditionalist }
					technologist = { text = ccfaction.1.technologist }
				}
			}
		}
	}
	
	
	trigger = {			#must disable for own ethic
		num_owned_planets > 5
		years_passed > 30
		
		NOT = { has_ethic = ethic_gestalt_consciousness }
		is_country_type = default
		
		#maybe I should make only one possible at a time as it might get messy?
		
		has_a_factional_revolt_active = no
		
		OR = {
			AND = {
				NOT = { has_country_flag = cc_imperialist_revolt_active }
				has_faction = imperialist
				NOR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = imperialist
						support > 0.15
						pop_percentage = {
							percentage > 0.74
							limit = { happiness < 0.4 }
						}
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = imperialist
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_isolationist_revolt_active }
				has_faction = isolationist
				NOR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}

				count_pop_factions = {
					limit = {
						is_pop_faction_type = isolationist
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = isolationist
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_progressive_revolt_active }
				has_faction = progressive
				NOR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = progressive
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = progressive
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_prosperity_revolt_active }
				has_faction = prosperity
				NOR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = prosperity
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = prosperity
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_supremacist_revolt_active }
				has_faction = supremacist
				NOR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = supremacist
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = supremacist
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_technologist_revolt_active }
				has_faction = technologist
				NOR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = technologist
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = technologist
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_totalitarian_revolt_active }
				has_faction = totalitarian
				NOR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = totalitarian
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = totalitarian
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_traditionalist_revolt_active }
				has_faction = traditionalist
				NOR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = traditionalist
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = traditionalist
					}
				}
			}
			AND = {
				NOT = { has_country_flag = cc_xenoist_revolt_active }
				has_faction = xenoist
				NOR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				
				count_pop_factions = {
					limit = {
						is_pop_faction_type = xenoist
						support > 0.15
					}
					count = 1
				}
				pop_percentage = {
					percentage > 0.1
					limit = {
						happiness < 40
						member_of_faction = xenoist
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		months = 600
		
		modifier = {
			factor = 2
			num_owned_planets < 10
		}
		
		modifier = {
			factor = 0.8
			num_owned_planets > 25
		}
		
		modifier = {
			factor = 0.67
			OR = {
				AND = {
					NOT = { has_country_flag = cc_imperialist_revolt_active }
					has_faction = imperialist
					NOR = {
						has_ethic = ethic_militarist
						has_ethic = ethic_fanatic_militarist
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = imperialist
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_isolationist_revolt_active }
					has_faction = isolationist
					NOR = {
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_xenophobe
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = isolationist
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_progressive_revolt_active }
					has_faction = progressive
					NOR = {
						has_ethic = ethic_egalitarian
						has_ethic = ethic_fanatic_egalitarian
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = progressive
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_prosperity_revolt_active }
					has_faction = prosperity
					NOR = {
						has_ethic = ethic_pacifist
						has_ethic = ethic_fanatic_pacifist
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = prosperity
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_supremacist_revolt_active }
					has_faction = supremacist
					NOR = {
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_xenophobe
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = supremacist
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_technologist_revolt_active }
					has_faction = technologist
					NOR = {
						has_ethic = ethic_materialist
						has_ethic = ethic_fanatic_materialist
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = technologist
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_totalitarian_revolt_active }
					has_faction = totalitarian
					NOR = {
						has_ethic = ethic_authoritarian
						has_ethic = ethic_fanatic_authoritarian
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = totalitarian
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_traditionalist_revolt_active }
					has_faction = traditionalist
					NOR = {
						has_ethic = ethic_spiritualist
						has_ethic = ethic_fanatic_spiritualist
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = traditionalist
						}
					}
				}
				AND = {
					NOT = { has_country_flag = cc_xenoist_revolt_active }
					has_faction = xenoist
					NOR = {
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_xenophile
					}
				
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 30
							member_of_faction = xenoist
						}
					}
				}
			}
		}

		modifier = {
			factor = 0.67
			any_owned_planet = {
				OR = {
					AND = {
						root = {
							NOT = { has_country_flag = cc_imperialist_revolt_active }
							has_faction = imperialist
							NOR = {
								has_ethic = ethic_militarist
								has_ethic = ethic_fanatic_militarist
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = imperialist
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_prosperity_revolt_active }
							has_faction = prosperity
							NOR = {
								has_ethic = ethic_pacifist
								has_ethic = ethic_fanatic_pacifist
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = prosperity
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_totalitarian_revolt_active }
							has_faction = totalitarian
							NOR = {
								has_ethic = ethic_authoritarian
								has_ethic = ethic_fanatic_authoritarian
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = totalitarian
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_progressive_revolt_active }
							has_faction = progressive
							NOR = {
								has_ethic = ethic_egalitarian
								has_ethic = ethic_fanatic_egalitarian
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = progressive
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_supremacist_revolt_active }
							has_faction = supremacist
							NOR = {
								has_ethic = ethic_xenophobe
								has_ethic = ethic_fanatic_xenophobe
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = supremacist
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_isolationist_revolt_active }
							has_faction = isolationist
							NOR = {
								has_ethic = ethic_xenophobe
								has_ethic = ethic_fanatic_xenophobe
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = isolationist
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_xenoist_revolt_active }
							has_faction = xenoist
							NOR = {
								has_ethic = ethic_xenophile
								has_ethic = ethic_fanatic_xenophile
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = xenoist
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_traditionalist_revolt_active }
							has_faction = traditionalist
							NOR = {
								has_ethic = ethic_spiritualist
								has_ethic = ethic_fanatic_spiritualist
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = traditionalist
							}
						}
					}
					AND = {
						root = {
							NOT = { has_country_flag = cc_technologist_revolt_active }
							has_faction = technologist
							NOR = {
								has_ethic = ethic_materialist
								has_ethic = ethic_fanatic_materialist
							}
						}
						pop_percentage = {
							percentage > 0.30
							limit = {
								happiness < 40
								member_of_faction = technologist
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {

#First event will be sort of 'warning signs' i.e. rumours of sedition but can't be proven, faction leader denies 
#anything. But planets with 4+ pops of the ethic get 'seditious talk' modifier, +75% ethics attraction. You also get
#a country modifier with -20% govt ethics attraction (for the whole event chain)

		random_list = { #so it only does one at a time
			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = imperialist }
						has_ethic = ethic_militarist
						has_ethic = ethic_fanatic_militarist
						
						NOT = {
							AND = {
								NOT = { has_country_flag = cc_imperialist_revolt_active }
								count_pop_factions = {
									limit = {
										is_pop_faction_type = imperialist
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = imperialist
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOT = { has_country_flag = cc_imperialist_revolt_active }
						has_faction = imperialist
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = imperialist
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_pacifist
						has_ethic = ethic_fanatic_pacifist
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_militarist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_militarist }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_militarist
						days = -1		#1800
					}
				}
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_imperialist_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_imperialist_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = imperialist }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = imperialist }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}

			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = isolationist }
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_xenophobe
						
						NOT = {
							AND = {
								NOR = {
									has_country_flag = cc_supremacist_revolt_active
									has_country_flag = cc_isolationist_revolt_active
								}
								count_pop_factions = {
									limit = {
										is_pop_faction_type = isolationist
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = isolationist
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOR = {
							has_country_flag = cc_supremacist_revolt_active
							has_country_flag = cc_isolationist_revolt_active
						}
						has_faction = isolationist
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = isolationist
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_xenophile
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_xenophobe }
							}
						}
						NOR = {
							has_modifier = cc_seditious_talk_xenophobe
							has_modifier = cc_faction_stronghold_supremacist
							has_modifier = cc_faction_stronghold_isolationist
							has_modifier = cc_faction_sympathies_supremacist
							has_modifier = cc_faction_sympathies_isolationist
						}						
					}
					add_modifier = {
						modifier = cc_seditious_talk_xenophobe
						days = -1		#1800
					}
				}
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_isolationist_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_isolationist_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = isolationist }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = isolationist }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}

			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = progressive }
						has_ethic = ethic_egalitarian
						has_ethic = ethic_fanatic_egalitarian
						
						NOT = {
							AND = {
								NOT = { has_country_flag = cc_progressive_revolt_active }
								count_pop_factions = {
									limit = {
										is_pop_faction_type = progressive
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = progressive
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOT = { has_country_flag = cc_progressive_revolt_active }
						has_faction = progressive
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = progressive
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_authoritarian
						has_ethic = ethic_fanatic_authoritarian
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { member_of_faction = progressive }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { member_of_faction = progressive }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_egalitarian
						days = -1		#1800
					}
				}
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_progressive_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_progressive_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = progressive }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = progressive }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}
			
			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = prosperity }
						has_ethic = ethic_pacifist
						has_ethic = ethic_fanatic_pacifist
						
						NOT = {
							AND = {
								NOT = { has_country_flag = cc_prosperity_revolt_active }
								count_pop_factions = {
									limit = {
										is_pop_faction_type = prosperity
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = prosperity
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOT = { has_country_flag = cc_prosperity_revolt_active }
						has_faction = prosperity
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = prosperity
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_militarist
						has_ethic = ethic_fanatic_militarist
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_egalitarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_egalitarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_pacifist
						days = -1		#1800
					}
				}
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_prosperity_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_prosperity_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = prosperity }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = prosperity }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}
			
			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = supremacist }
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_xenophobe
						
						NOT = {
							AND = {
								NOR = {
									has_country_flag = cc_supremacist_revolt_active
									has_country_flag = cc_isolationist_revolt_active
								}
								count_pop_factions = {
									limit = {
										is_pop_faction_type = supremacist
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = supremacist
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOR = {
							has_country_flag = cc_supremacist_revolt_active
							has_country_flag = cc_isolationist_revolt_active
						}
						has_faction = supremacist
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = supremacist
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_xenophile
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_xenophobe }
							}
						}
						NOR = {
							has_modifier = cc_seditious_talk_xenophobe
							has_modifier = cc_faction_stronghold_supremacist
							has_modifier = cc_faction_stronghold_isolationist
							has_modifier = cc_faction_sympathies_supremacist
							has_modifier = cc_faction_sympathies_isolationist
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_xenophobe
						days = -1		#1800
					}
				}
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_supremacist_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_supremacist_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = supremacist }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = supremacist }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}
			
			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = technologist }
						has_ethic = ethic_materialist
						has_ethic = ethic_fanatic_materialist
						
						NOT = {
							AND = {
								NOT = { has_country_flag = cc_technologist_revolt_active }
								count_pop_factions = {
									limit = {
										is_pop_faction_type = technologist
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = technologist
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOT = { has_country_flag = cc_technologist_revolt_active }
						has_faction = technologist
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = technologist
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_spiritualist
						has_ethic = ethic_fanatic_spiritualist
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_materialist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_materialist }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_materialist
						days = -1		#1800
					}
				}
				
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_technologist_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_technologist_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = technologist }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = technologist }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}
			
			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = totalitarian }
						has_ethic = ethic_authoritarian
						has_ethic = ethic_fanatic_authoritarian
						
						NOT = {
							AND = {
								NOT = { has_country_flag = cc_totalitarian_revolt_active }
								count_pop_factions = {
									limit = {
										is_pop_faction_type = totalitarian
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = totalitarian
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOT = { has_country_flag = cc_totalitarian_revolt_active }
						has_faction = totalitarian
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = totalitarian
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_egalitarian
						has_ethic = ethic_fanatic_egalitarian
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_authoritarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_authoritarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_authoritarian
						days = -1		#1800
					}
				}
				
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_totalitarian_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_totalitarian_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = totalitarian }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = totalitarian }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}
			
			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = traditionalist }
						has_ethic = ethic_spiritualist
						has_ethic = ethic_fanatic_spiritualist
						
						NOT = {
							AND = {
								NOT = { has_country_flag = cc_traditionalist_revolt_active }
								count_pop_factions = {
									limit = {
										is_pop_faction_type = traditionalist
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = traditionalist
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOT = { has_country_flag = cc_traditionalist_revolt_active }
						has_faction = traditionalist
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = traditionalist
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_materialist
						has_ethic = ethic_fanatic_materialist
					}
				}
				
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_spiritualist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_spiritualist }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_spiritualist
						days = -1		#1800
					}
				}
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_traditionalist_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_traditionalist_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = traditionalist }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = traditionalist }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}
			
			1 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_faction = xenoist }
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_xenophile
						
						NOT = {
							AND = {
								NOT = { has_country_flag = cc_xenoist_revolt_active }
								count_pop_factions = {
									limit = {
										is_pop_faction_type = xenoist
										support > 0.15
									}
									count = 1
								}
								pop_percentage = {
									percentage > 0.1
									limit = {
										happiness < 40
										member_of_faction = xenoist
									}
								}
							}
						}
					}
				}
				modifier = {
					factor = 2
					AND = {
						NOT = { has_country_flag = cc_xenoist_revolt_active }
						has_faction = xenoist
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 30
								member_of_faction = xenoist
							}
						}
					}
				}
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_xenophobe
					}
				}

				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophile }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_xenophile }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_xenophile
						days = -1		#1800
					}
				}
				
#				hidden_effect = {
					set_timed_country_flag = {
						flag = cc_xenoist_revolt_active
						days = 5400		#15 years
					}
					set_timed_country_flag = {
						flag = cc_xenoist_seditions_active
						days = 1800		#5 years
					}
					
					#set event targets
					
					random_pop_faction = {
						limit = { is_pop_faction_type = xenoist }
						save_event_target_as = cc_rebellious_faction
					}
					
					random_owned_leader = {
						limit = { leader_of_faction = xenoist }
						save_event_target_as = cc_rebellious_faction_leader
					}
#				}
				country_event = { id = ccfaction.2 days = 1800 }
				country_event = { id = ccfaction.21 days = 1801 }
			}
		}
	}
	option = {
		name = CCWORRYING
		
		
		tooltip = {
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = imperialist }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_militarist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_militarist }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_militarist
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = isolationist }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_xenophobe }
							}
						}
						NOR = {
							has_modifier = cc_seditious_talk_xenophobe
							has_modifier = cc_faction_stronghold_supremacist
							has_modifier = cc_faction_stronghold_isolationist
							has_modifier = cc_faction_sympathies_supremacist
							has_modifier = cc_faction_sympathies_isolationist
						}						
					}
					add_modifier = {
						modifier = cc_seditious_talk_xenophobe
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = progressive }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { member_of_faction = progressive }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { member_of_faction = progressive }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_egalitarian
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = prosperity }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_egalitarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_egalitarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_pacifist
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = supremacist }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_xenophobe }
							}
						}
						NOR = {
							has_modifier = cc_seditious_talk_xenophobe
							has_modifier = cc_faction_stronghold_supremacist
							has_modifier = cc_faction_stronghold_isolationist
							has_modifier = cc_faction_sympathies_supremacist
							has_modifier = cc_faction_sympathies_isolationist
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_xenophobe
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = technologist }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_materialist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_materialist }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_materialist
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = totalitarian }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_authoritarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_authoritarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_authoritarian
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = traditionalist }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_spiritualist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_spiritualist }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_spiritualist
						days = -1		#1800
					}
				}
			}
			
			if = {
				limit = {
					event_target:cc_rebellious_faction = { is_pop_faction_type = xenoist }
				}
				if = {
					limit = { NOT = { has_modifier = cc_country_factional_unrest } }
					add_modifier = {
						modifier = cc_country_factional_unrest
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophile }
								count > 3
							}
							pop_percentage = {
								percentage > 0.24
								limit = { has_ethic = ethic_xenophile }
							}
						}
					}
					add_modifier = {
						modifier = cc_seditious_talk_xenophile
						days = -1		#1800
					}
				}
			}
		}
	}
}


#second event

country_event = {
	id = ccfaction.2
	title = ccfaction.2.name
	picture = GFX_evt_alien_propaganda
	
	desc = {
		trigger = {
			hidden:event_target:cc_rebellious_faction = {
				switch = {
					trigger = is_pop_faction_type
					xenoist = { text = ccfaction.2.xenoist }
					supremacist = { text = ccfaction.2.supremacist }
					isolationist = { text = ccfaction.2.isolationist }
					progressive = { text = ccfaction.2.progressive }
					totalitarian = { text = ccfaction.2.totalitarian }
					imperialist = { text = ccfaction.2.imperialist }
					prosperity = { text = ccfaction.2.prosperity }
					traditionalist = { text = ccfaction.2.traditionalist }
					technologist = { text = ccfaction.2.technologist }
				}
			}
		}
	}
	is_triggered_only = yes
	
	trigger = {
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = xenoist } }
			
			has_faction = xenoist
			count_pop_factions = {
				limit = {
					is_pop_faction_type = xenoist
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = xenoist
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = xenoist }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = supremacist } }
			
			has_faction = supremacist
			count_pop_factions = {
				limit = {
					is_pop_faction_type = supremacist
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = supremacist
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = supremacist }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = isolationist } }
			
			has_faction = isolationist
			count_pop_factions = {
				limit = {
					is_pop_faction_type = isolationist
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = isolationist
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = isolationist }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = totalitarian } }
			
			has_faction = totalitarian
			count_pop_factions = {
				limit = {
					is_pop_faction_type = totalitarian
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = totalitarian
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = totalitarian }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = progressive } }
			
			has_faction = progressive
			count_pop_factions = {
				limit = {
					is_pop_faction_type = progressive
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = progressive
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = progressive }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = prosperity } }
			
			has_faction = prosperity
			count_pop_factions = {
				limit = {
					is_pop_faction_type = prosperity
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = prosperity
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = prosperity }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = imperialist } }
			
			has_faction = imperialist
			count_pop_factions = {
				limit = {
					is_pop_faction_type = imperialist
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = imperialist
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = imperialist }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = traditionalist } }
			
			has_faction = traditionalist
			count_pop_factions = {
				limit = {
					is_pop_faction_type = traditionalist
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = traditionalist
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = traditionalist }
				}
			}
		}
		if = {
			limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = technologist } }
			
			has_faction = technologist
			count_pop_factions = {
				limit = {
					is_pop_faction_type = technologist
					support > 0.15
				}
				count = 1
			}
			pop_percentage = {
				percentage > 0.1
				limit = {
					happiness < 40
					member_of_faction = technologist
				}
			}
			any_owned_planet = {
				pop_percentage = {
					percentage > 0.25
					limit = { member_of_faction = technologist }
				}
			}
		}
	}
	
	immediate = {
		set_timed_country_flag = {
			flag = cc_continue_factional_revolt
			days = 2
		}
	}
	option = {
		name = CCWORRYING
		
		#xenoist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = xenoist }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_xenoist_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = xenoist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_xenoist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = xenoist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophile }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophile }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_xenoist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_xenoist
						has_modifier = cc_faction_sympathies_xenoist
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_xenoist
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_xenoist
					days = -1
				}
			}
		}
		
		#supremacist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = supremacist }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_supremacist_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = supremacist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_supremacist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = supremacist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_supremacist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_supremacist
						has_modifier = cc_faction_sympathies_supremacist
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_supremacist
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_supremacist
					days = -1
				}
			}
		}
		
		#isolationist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = isolationist }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_isolationist_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = isolationist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_isolationist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = isolationist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_isolationist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_isolationist
						has_modifier = cc_faction_sympathies_isolationist
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_isolationist
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_isolationist
					days = -1
				}
			}
		}
		
		#progressive
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = progressive }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_progressive_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = progressive }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_progressive
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = progressive }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_egalitarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_egalitarian }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_progressive
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_progressive
						has_modifier = cc_faction_sympathies_progressive
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_progressive
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_progressive
					days = -1
				}
			}
		}
		
		#totalitarian
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = totalitarian }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_totalitarian_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = totalitarian }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_totalitarian
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = totalitarian }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_authoritarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_authoritarian }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_totalitarian
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_totalitarian
						has_modifier = cc_faction_sympathies_totalitarian
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_totalitarian
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_totalitarian
					days = -1
				}
			}
		}
		
		#imperialist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = imperialist }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_imperialist_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = imperialist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_imperialist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = imperialist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_militarist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_militarist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_imperialist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_imperialist
						has_modifier = cc_faction_sympathies_imperialist
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_imperialist
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_imperialist
					days = -1
				}
			}
		}
		
		#prosperity
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = prosperity }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_prosperity_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = prosperity }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_prosperity
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = prosperity }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_pacifist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_pacifist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_prosperity
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_prosperity
						has_modifier = cc_faction_sympathies_prosperity
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_prosperity
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_prosperity
					days = -1
				}
			}
		}
		
		#traditionalist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = traditionalist }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_traditionalist_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = traditionalist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_traditionalist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = traditionalist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_spiritualist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_spiritualist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_traditionalist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_traditionalist
						has_modifier = cc_faction_sympathies_traditionalist
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_traditionalist
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_traditionalist
					days = -1
				}
			}
		}
		
		#technologist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = technologist }
			}
			hidden_effect = {
				country_event = { id = ccfaction.3 days = 540 } #faction allies with them
				country_event = { id = ccfaction.4 days = 1080 } #stage 3
				country_event = { id = ccfaction.41 days = 1081 } #stage 3 fails
				set_timed_country_flag = {
					flag = cc_technologist_stage2_active
					days = 1080
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophile }
					remove_modifier = cc_seditious_talk_xenophile
				}
			}
			every_owned_planet = {
				limit = {
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = technologist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_technologist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = technologist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_materialist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_materialist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_technologist
					days = -1
				}
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_faction_stronghold_technologist
						has_modifier = cc_faction_sympathies_technologist
					}
					owner = {
						any_owned_planet = {
							has_modifier = cc_faction_stronghold_technologist
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sedition_technologist
					days = -1
				}
			}
		}
	}
}

#factional revolt peters out after stage 1
country_event = {
	id = ccfaction.21
	title = ccfaction.21.name
	desc = {
		trigger = { event_target:cc_rebellious_faction = { NOT = { has_modifier = embraced_faction } } }
		text = ccfaction.21.desc.fail
	}
	desc = {
		trigger = { event_target:cc_rebellious_faction = { has_modifier = embraced_faction } }
		text = ccfaction.21.desc.succeed
	}
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes
	
	trigger = { NOT = { has_country_flag = cc_continue_factional_revolt } }
	
	immediate = {
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = xenoist }
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_xenophile }
				remove_modifier = cc_seditious_talk_xenophile
			}
			remove_country_flag = cc_xenoist_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#supremacist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = supremacist }
			}
			if = {
				limit = {
					NOT = { has_country_flag = cc_isolationist_revolt_active }
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophobe }
					remove_modifier = cc_seditious_talk_xenophobe
				}
			}
			remove_country_flag = cc_supremacist_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#isolationist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = isolationist }
			}
			if = {
				limit = {
					NOT = { has_country_flag = cc_supremacist_revolt_active }
				}
				every_owned_planet = {
					limit = { has_modifier = cc_seditious_talk_xenophobe }
					remove_modifier = cc_seditious_talk_xenophobe
				}
			}
			remove_country_flag = cc_isolationist_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#progressive
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = progressive }
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_egalitarian }
				remove_modifier = cc_seditious_talk_egalitarian
			}
			remove_country_flag = cc_progressive_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#totalitarian
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = totalitarian }
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_authoritarian }
				remove_modifier = cc_seditious_talk_authoritarian
			}
			remove_country_flag = cc_totalitarian_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#imperialist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = imperialist }
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_militarist }
				remove_modifier = cc_seditious_talk_militarist
			}
			remove_country_flag = cc_imperialist_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#prosperity
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = prosperity }
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_pacifist }
				remove_modifier = cc_seditious_talk_pacifist
			}
			remove_country_flag = cc_prosperity_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#traditionalist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = traditionalist }
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_spiritualist }
				remove_modifier = cc_seditious_talk_spiritualist
			}
			remove_country_flag = cc_traditionalist_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
		
		#technologist
		if = {
			limit = {
				event_target:cc_rebellious_faction = { is_pop_faction_type = technologist }
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_materialist }
				remove_modifier = cc_seditious_talk_materialist
			}
			remove_country_flag = cc_technologist_revolt_active
			if = {
				limit = {
					NOR = {
						has_country_flag = cc_xenoist_revolt_active
						has_country_flag = cc_imperialist_revolt_active
						has_country_flag = cc_traditionalist_revolt_active
						has_country_flag = cc_supremacist_revolt_active
						has_country_flag = cc_isolationist_revolt_active
						has_country_flag = cc_progressive_revolt_active
						has_country_flag = cc_prosperity_revolt_active
						has_country_flag = cc_technologist_revolt_active
						has_country_flag = cc_totalitarian_revolt_active
					}
				}
				remove_modifier = cc_country_factional_unrest
			}
		}
	}
	option = { name = CCGOOD }
}


#Event 2.5: Another faction joins the revolt
country_event = {
	id = ccfaction.3
	title = ccfaction.3.name
	desc = ccfaction.3.desc
	
	picture = GFX_evt_alien_propaganda
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = xenoist
							is_pop_faction_type = supremacist
						}
					}
				}
				has_faction = supremacist
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = supremacist
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = supremacist
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = supremacist
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = xenoist
							is_pop_faction_type = isolationist
						}
					}
				}
				has_faction = isolationist
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = isolationist
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = isolationist
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = isolationist
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = xenoist
							is_pop_faction_type = isolationist
							is_pop_faction_type = supremacist
						}
					}
				}
				has_faction = xenoist
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = xenoist
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = xenoist
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = xenoist
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = progressive
							is_pop_faction_type = totalitarian
						}
					}
				}
				has_faction = progressive
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = progressive
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = progressive
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = progressive
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = progressive
							is_pop_faction_type = totalitarian
						}
					}
				}
				has_faction = totalitarian
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = totalitarian
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = totalitarian
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = totalitarian
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = technologist
							is_pop_faction_type = traditionalist
						}
					}
				}
				has_faction = technologist
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = technologist
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = technologist
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = technologist
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = technologist
							is_pop_faction_type = traditionalist
						}
					}
				}
				has_faction = traditionalist
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = traditionalist
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = traditionalist
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = traditionalist
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = imperialist
							is_pop_faction_type = prosperity
						}
					}
				}
				has_faction = imperialist
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = imperialist
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = imperialist
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = imperialist
						}
					}
				}
			}
			AND = {
				NOT = {
					event_target:cc_rebellious_faction = {
						OR = {
							is_pop_faction_type = imperialist
							is_pop_faction_type = prosperity
						}
					}
				}
				has_faction = prosperity
				OR = {
					pop_percentage = {
						percentage > 0.15
						limit = {
							happiness < 40
							member_of_faction = prosperity
						}
					}
					pop_percentage = {
						percentage > 0.10
						limit = {
							happiness < 35
							member_of_faction = prosperity
						}
					}
					pop_percentage = {
						percentage > 0.05
						limit = {
							happiness < 30
							member_of_faction = prosperity
						}
					}
				}
			}
		}
	}
	
	immediate = {
		random_list = {
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = xenoist
								is_pop_faction_type = supremacist
								is_pop_faction_type = isolationist
							}
						}
						NOT = { has_faction = xenoist }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = xenoist
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = xenoist
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = xenoist
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = xenoist
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = xenoist
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = xenoist }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_xenoist_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_xenoist_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = xenoist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_xenoist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = xenoist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophile }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophile }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_xenoist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_xenoist
							has_modifier = cc_faction_sympathies_xenoist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_xenoist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_xenoist
						days = -1
					}
				}
			}

			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = xenoist
								is_pop_faction_type = supremacist
							}
						}
						NOT = { has_faction = supremacist }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = supremacist
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = supremacist
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = supremacist
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = supremacist
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = supremacist
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = supremacist }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_supremacist_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_supremacist_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = supremacist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_supremacist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = supremacist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophobe }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_supremacist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_supremacist
							has_modifier = cc_faction_sympathies_supremacist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_supremacist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_supremacist
						days = -1
					}
				}
			}
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = xenoist
								is_pop_faction_type = isolationist
							}
						}
						NOT = { has_faction = isolationist }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = isolationist
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = isolationist
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = isolationist
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = isolationist
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = isolationist
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = isolationist }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_isolationist_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_isolationist_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = isolationist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_isolationist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = isolationist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophobe }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_isolationist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_isolationist
							has_modifier = cc_faction_sympathies_isolationist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_isolationist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_isolationist
						days = -1
					}
				}
			}
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = technologist
								is_pop_faction_type = traditionalist
							}
						}
						NOT = { has_faction = traditionalist }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = traditionalist
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = traditionalist
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = traditionalist
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = traditionalist
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = traditionalist
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = traditionalist }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_traditionalist_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_traditionalist_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = traditionalist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_traditionalist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = traditionalist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_spiritualist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_spiritualist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_traditionalist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_traditionalist
							has_modifier = cc_faction_sympathies_traditionalist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_traditionalist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_traditionalist
						days = -1
					}
				}
			}
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = technologist
								is_pop_faction_type = traditionalist
							}
						}
						NOT = { has_faction = technologist }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = technologist
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = technologist
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = technologist
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = technologist
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = technologist
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = technologist }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_technologist_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_technologist_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = technologist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_technologist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = technologist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_materialist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_materialist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_technologist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_technologist
							has_modifier = cc_faction_sympathies_technologist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_technologist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_technologist
						days = -1
					}
				}
			}
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = totalitarian
								is_pop_faction_type = progressive
							}
						}
						NOT = { has_faction = totalitarian }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = totalitarian
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = totalitarian
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = totalitarian
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = totalitarian
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = totalitarian
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = totalitarian }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_totalitarian_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_totalitarian_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = totalitarian }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_totalitarian
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = totalitarian }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_authoritarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_authoritarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_totalitarian
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_totalitarian
							has_modifier = cc_faction_sympathies_totalitarian
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_totalitarian
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_totalitarian
						days = -1
					}
				}
			}
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = progressive
								is_pop_faction_type = totalitarian
							}
						}
						NOT = { has_faction = progressive }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = progressive
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = progressive
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = progressive
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = progressive
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = progressive
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = progressive }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_progressive_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_progressive_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = progressive }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_progressive
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = progressive }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_egalitarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_egalitarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_progressive
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_progressive
							has_modifier = cc_faction_sympathies_progressive
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_progressive
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_progressive
						days = -1
					}
				}
			}
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = imperialist
								is_pop_faction_type = prosperity
							}
						}
						NOT = { has_faction = imperialist }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = imperialist
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = imperialist
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = imperialist
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = imperialist
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = imperialist
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = imperialist }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_imperialist_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_imperialist_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = imperialist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_imperialist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = imperialist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_militarist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_militarist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_imperialist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_imperialist
							has_modifier = cc_faction_sympathies_imperialist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_imperialist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_imperialist
						days = -1
					}
				}
			}
			1 = {
				modifier = {
					factor = 0
					OR = {
						event_target:cc_rebellious_faction = {
							OR = {
								is_pop_faction_type = imperialist
								is_pop_faction_type = prosperity
							}
						}
						NOT = { has_faction = prosperity }
						NOR = {
							pop_percentage = {
								percentage > 0.15
								limit = {
									happiness < 40
									member_of_faction = prosperity
								}
							}
							pop_percentage = {
								percentage > 0.10
								limit = {
									happiness < 35
									member_of_faction = prosperity
								}
							}
							pop_percentage = {
								percentage > 0.05
								limit = {
									happiness < 30
									member_of_faction = prosperity
								}
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.15
							limit = {
								happiness < 40
								member_of_faction = prosperity
							}
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						pop_percentage = {
							percentage > 0.10
							limit = {
								happiness < 35
								member_of_faction = prosperity
							}
						}
					}
				}
				
				random_pop_faction = {
					limit = { is_pop_faction_type = prosperity }
					save_event_target_as = cc_new_reb_faction
				}
				
				set_timed_country_flag = {
					flag = cc_prosperity_secondary_revolt_active
					days = 1080
				}
				
				set_timed_country_flag = {
					flag = cc_prosperity_stage2_active
					days = 540
				}
				
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = prosperity }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_prosperity
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = prosperity }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_pacifist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_pacifist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_prosperity
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_prosperity
							has_modifier = cc_faction_sympathies_prosperity
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_prosperity
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_prosperity
						days = -1
					}
				}
			}
		}
	}
							
					
	option = {
		name = CCWORRYING
		
		tooltip = {
		
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = xenoist }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = xenoist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_xenoist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = xenoist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophile }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophile }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_xenoist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_xenoist
							has_modifier = cc_faction_sympathies_xenoist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_xenoist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_xenoist
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = supremacist }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = supremacist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_supremacist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = supremacist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophobe }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_supremacist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_supremacist
							has_modifier = cc_faction_sympathies_supremacist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_supremacist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_supremacist
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = isolationist }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = isolationist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_isolationist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = isolationist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophobe }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_isolationist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_isolationist
							has_modifier = cc_faction_sympathies_isolationist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_isolationist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_isolationist
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = traditionalist }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = traditionalist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_traditionalist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = traditionalist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_spiritualist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_spiritualist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_traditionalist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_traditionalist
							has_modifier = cc_faction_sympathies_traditionalist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_traditionalist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_traditionalist
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = technologist }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = technologist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_technologist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = technologist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_materialist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_materialist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_technologist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_technologist
							has_modifier = cc_faction_sympathies_technologist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_technologist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_technologist
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = totalitarian }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = totalitarian }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_totalitarian
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = totalitarian }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_authoritarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_authoritarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_totalitarian
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_totalitarian
							has_modifier = cc_faction_sympathies_totalitarian
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_totalitarian
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_totalitarian
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = progressive }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = progressive }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_progressive
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = progressive }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_egalitarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_egalitarian }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_progressive
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_progressive
							has_modifier = cc_faction_sympathies_progressive
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_progressive
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_progressive
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = imperialist }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = imperialist }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_imperialist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = imperialist }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_militarist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_militarist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_imperialist
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_imperialist
							has_modifier = cc_faction_sympathies_imperialist
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_imperialist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_imperialist
						days = -1
					}
				}
			}
			if = {
				limit = {
					event_target:cc_new_reb_faction = { is_pop_faction_type = prosperity }
				}
				every_owned_planet = {
					limit = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = prosperity }
						}
					}
					add_modifier = {
						modifier = cc_faction_stronghold_prosperity
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOT = {
							pop_percentage = {
								percentage > 0.25
								limit = { member_of_faction = prosperity }
							}
						}
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_pacifist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_pacifist }
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sympathies_prosperity
						days = -1
					}
				}
				every_owned_planet = {
					limit = {
						NOR = {
							has_modifier = cc_faction_stronghold_prosperity
							has_modifier = cc_faction_sympathies_prosperity
						}
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_prosperity
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
					add_modifier = {
						modifier = cc_faction_sedition_prosperity
						days = -1
					}
				}
			}
		}
	}
}



#stage 3

country_event = {
	id = ccfaction.4
	title = ccfaction.4.name
	desc = {
		trigger = { has_secondary_factional_revolt_active = yes }
		text = ccfaction.4.dual.desc
	}
	desc = {
		trigger = { has_secondary_factional_revolt_active = no }
		text = ccfaction.4.single.desc
	}
	picture = GFX_evt_alien_propaganda
	
	is_triggered_only = yes
	
	trigger = {
		if = {
			limit = { num_owned_planets < 7 }
			any_owned_planet = { is_faction_stronghold = yes }
			
			else = {
				if = {
					limit = { num_owned_planets < 11 }
					any_owned_planet = {
						is_faction_stronghold = yes
						root = {
							any_owned_planet = {
								NOT = { is_same_value = prevprev }
								is_faction_stronghold = yes
							}
						}
					}
					
					else = {
						if = {
							limit = { num_owned_planets < 20 }
							any_owned_planet = {
								is_faction_stronghold = yes
								root = {
									any_owned_planet = {
										NOT = { is_same_value = prevprev }
										is_faction_stronghold = yes
										root = {
											any_owned_planet = {
												NOR = {
													is_same_value = prevprev
													is_same_value = prevprevprevprev
												}
												is_faction_stronghold = yes
											}
										}
									}
								}
							}
							else = {
								OR = {
									any_owned_planet = {
										has_planet_flag = ccrebel_red
										is_faction_stronghold = yes
										root = {
											any_owned_planet = {
												NOT = { is_same_value = prevprev }
												is_faction_stronghold = yes
												root = {
													any_owned_planet = {
														NOR = {
															is_same_value = prevprev
															is_same_value = prevprevprevprev
														}
														is_faction_stronghold = yes
														root = {
															any_owned_planet = {
																NOT = { has_planet_flag = ccrebel_red }
																NOR = {
																	is_same_value = prevprev
																	is_same_value = prevprevprevprev
																}
																is_faction_stronghold = yes
															}
														}
													}
												}
											}
										}
									}
									any_owned_planet = {
										has_planet_flag = ccrebel_green
										is_faction_stronghold = yes
										root = {
											any_owned_planet = {
												NOT = { is_same_value = prevprev }
												is_faction_stronghold = yes
												root = {
													any_owned_planet = {
														NOR = {
															is_same_value = prevprev
															is_same_value = prevprevprevprev
														}
														is_faction_stronghold = yes
														root = {
															any_owned_planet = {
																NOT = { has_planet_flag = ccrebel_green }
																NOR = {
																	is_same_value = prevprev
																	is_same_value = prevprevprevprev
																}
																is_faction_stronghold = yes
															}
														}
													}
												}
											}
										}
									}
									any_owned_planet = {
										has_planet_flag = ccrebel_blue
										is_faction_stronghold = yes
										root = {
											any_owned_planet = {
												NOT = { is_same_value = prevprev }
												is_faction_stronghold = yes
												root = {
													any_owned_planet = {
														NOR = {
															is_same_value = prevprev
															is_same_value = prevprevprevprev
														}
														is_faction_stronghold = yes
														root = {
															any_owned_planet = {
																NOT = { has_planet_flag = ccrebel_blue }
																NOR = {
																	is_same_value = prevprev
																	is_same_value = prevprevprevprev
																}
																is_faction_stronghold = yes
															}
														}
													}
												}
											}
										}
									}
									any_owned_planet = {
										has_planet_flag = ccrebel_yellow
										is_faction_stronghold = yes
										root = {
											any_owned_planet = {
												NOT = { is_same_value = prevprev }
												is_faction_stronghold = yes
												root = {
													any_owned_planet = {
														NOR = {
															is_same_value = prevprev
															is_same_value = prevprevprevprev
														}
														is_faction_stronghold = yes
														root = {
															any_owned_planet = {
																NOT = { has_planet_flag = ccrebel_yellow }
																NOR = {
																	is_same_value = prevprev
																	is_same_value = prevprevprevprev
																}
																is_faction_stronghold = yes
															}
														}
													}
												}
											}
										}
									}
									any_owned_planet = {
										has_planet_flag = ccrebel_white
										is_faction_stronghold = yes
										root = {
											any_owned_planet = {
												NOT = { is_same_value = prevprev }
												is_faction_stronghold = yes
												root = {
													any_owned_planet = {
														NOR = {
															is_same_value = prevprev
															is_same_value = prevprevprevprev
														}
														is_faction_stronghold = yes
														root = {
															any_owned_planet = {
																NOT = { has_planet_flag = ccrebel_white }
																NOR = {
																	is_same_value = prevprev
																	is_same_value = prevprevprevprev
																}
																is_faction_stronghold = yes
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
	
		country_event = { id = ccfaction.42 days = 541 }
		country_event = { id = ccfaction.900 days = 2521 }
		
		#set event targets for the second faction (for desc)
		if = {
			limit = { has_secondary_factional_revolt_active = yes }
			if = {
				limit = { has_country_flag = cc_imperialist_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = imperialist }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_imperialist_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_prosperity_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = prosperity }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_prosperity_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_totalitarian_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = totalitarian }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_totalitarian_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_progressive_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = progressive }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_progressive_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_technologist_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = technologist }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_technologist_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_traditionalist_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = traditionalist }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_traditionalist_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_xenoist_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = xenoist }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_xenoist_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_supremacist_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = supremacist }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_supremacist_stage3_active
					days = 2520
				}
			}
			if = {
				limit = { has_country_flag = cc_isolationist_secondary_revolt_active }
				random_pop_faction = {
					limit = { is_pop_faction_type = isolationist }
					save_event_target_as = cc_new_reb_faction
				}
				set_timed_country_flag = {
					flag = cc_isolationist_stage3_active
					days = 2520
				}
			}
		}
		
		set_timed_country_flag = {
			flag = cc_continue_factional_revolt
			days = 3
		}
		
		if = {
			limit = { has_country_flag = cc_imperialist_revolt_active }
			set_timed_country_flag = {
				flag = cc_imperialist_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_prosperity_revolt_active }
			set_timed_country_flag = {
				flag = cc_prosperity_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_totalitarian_revolt_active }
			set_timed_country_flag = {
				flag = cc_totalitarian_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_progressive_revolt_active }
			set_timed_country_flag = {
				flag = cc_progressive_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_technologist_revolt_active }
			set_timed_country_flag = {
				flag = cc_technologist_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_traditionalist_revolt_active }
			set_timed_country_flag = {
				flag = cc_traditionalist_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_xenoist_revolt_active }
			set_timed_country_flag = {
				flag = cc_xenoist_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_supremacist_revolt_active }
			set_timed_country_flag = {
				flag = cc_supremacist_stage3_active
				days = 2520
			}
		}
		if = {
			limit = { has_country_flag = cc_isolationist_revolt_active }
			set_timed_country_flag = {
				flag = cc_isolationist_stage3_active
				days = 2520
			}
		}
		
		
		every_owned_planet = {
			limit = { is_faction_stronghold = yes }
			add_modifier = {
				modifier = cc_faction_acute_unrest
				days = 540
			}
			set_timed_planet_flag = {
				flag = recent_unrest_event
				days = 540
			}
		}
	}
	option = {
		name = CCWORRYING
		
		tooltip = {
			every_owned_planet = {
				limit = { is_faction_stronghold = yes }
				add_modifier = {
					modifier = cc_faction_acute_unrest
					days = 540
				}
			}
		}
	}
}

#stage 2 fails
country_event = {
	id = ccfaction.41
	title = ccfaction.41.name
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = yes
			event_target:cc_rebellious_faction = { has_modifier = embraced_faction }
		}
		text = ccfaction.41.dual.succeed.desc
	}
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = no
			event_target:cc_rebellious_faction = { has_modifier = embraced_faction }
		}
		text = ccfaction.41.single.succeed.desc
	}
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = yes
			event_target:cc_rebellious_faction = { NOT = { has_modifier = embraced_faction } }
		}
		text = ccfaction.41.dual.fail.desc
	}
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = no
			event_target:cc_rebellious_faction = { NOT = { has_modifier = embraced_faction } }
		}
		text = ccfaction.41.fail.succeed.desc
	}
	picture = GFX_evt_arguing_senate

	is_triggered_only = yes
	
	trigger = { NOT = { has_country_flag = cc_continue_factional_revolt } }
	
	immediate = {
		remove_modifier = cc_country_factional_unrest
		
		if = {
			limit = {
				OR = {
					has_country_flag = cc_xenoist_secondary_revolt_active
					has_country_flag = cc_xenoist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_xenoist_secondary_revolt_active }
				remove_country_flag = cc_xenoist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = xenoist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_xenoist_revolt_active }
				remove_country_flag = cc_xenoist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_xenoist_stage2_active }
				remove_country_flag = cc_xenoist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_xenoist_stage3_active }
				remove_country_flag = cc_xenoist_stage3_active
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_xenoist }
				remove_modifier = cc_faction_stronghold_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_xenoist }
				remove_modifier = cc_faction_sympathies_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_xenoist }
				remove_modifier = cc_faction_sedition_xenoist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_isolationist_secondary_revolt_active
					has_country_flag = cc_isolationist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_isolationist_secondary_revolt_active }
				remove_country_flag = cc_isolationist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = isolationist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_isolationist_revolt_active }
				remove_country_flag = cc_isolationist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_isolationist_stage2_active }
				remove_country_flag = cc_isolationist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_isolationist_stage3_active }
				remove_country_flag = cc_isolationist_stage3_active
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_isolationist }
				remove_modifier = cc_faction_stronghold_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_isolationist }
				remove_modifier = cc_faction_sympathies_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_isolationist }
				remove_modifier = cc_faction_sedition_isolationist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_supremacist_secondary_revolt_active
					has_country_flag = cc_supremacist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_supremacist_secondary_revolt_active }
				remove_country_flag = cc_supremacist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = supremacist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_supremacist_revolt_active }
				remove_country_flag = cc_supremacist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_supremacist_stage2_active }
				remove_country_flag = cc_supremacist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_supremacist_stage3_active }
				remove_country_flag = cc_supremacist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_supremacist }
				remove_modifier = cc_faction_stronghold_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_supremacist }
				remove_modifier = cc_faction_sympathies_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_supremacist }
				remove_modifier = cc_faction_sedition_supremacist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_technologist_secondary_revolt_active
					has_country_flag = cc_technologist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_technologist_secondary_revolt_active }
				remove_country_flag = cc_technologist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = technologist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_technologist_revolt_active }
				remove_country_flag = cc_technologist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_technologist_stage2_active }
				remove_country_flag = cc_technologist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_technologist_stage3_active }
				remove_country_flag = cc_technologist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_technologist }
				remove_modifier = cc_faction_stronghold_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_technologist }
				remove_modifier = cc_faction_sympathies_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_technologist }
				remove_modifier = cc_faction_sedition_technologist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_traditionalist_secondary_revolt_active
					has_country_flag = cc_traditionalist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_traditionalist_secondary_revolt_active }
				remove_country_flag = cc_traditionalist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = traditionalist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_traditionalist_revolt_active }
				remove_country_flag = cc_traditionalist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_traditionalist_stage2_active }
				remove_country_flag = cc_traditionalist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_traditionalist_stage3_active }
				remove_country_flag = cc_traditionalist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_traditionalist }
				remove_modifier = cc_faction_stronghold_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_traditionalist }
				remove_modifier = cc_faction_sympathies_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_traditionalist }
				remove_modifier = cc_faction_sedition_traditionalist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_imperialist_secondary_revolt_active
					has_country_flag = cc_imperialist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_imperialist_secondary_revolt_active }
				remove_country_flag = cc_imperialist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = imperialist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_imperialist_revolt_active }
				remove_country_flag = cc_imperialist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_imperialist_stage2_active }
				remove_country_flag = cc_imperialist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_imperialist_stage3_active }
				remove_country_flag = cc_imperialist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_imperialist }
				remove_modifier = cc_faction_stronghold_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_imperialist }
				remove_modifier = cc_faction_sympathies_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_imperialist }
				remove_modifier = cc_faction_sedition_imperialist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_prosperity_secondary_revolt_active
					has_country_flag = cc_prosperity_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_prosperity_secondary_revolt_active }
				remove_country_flag = cc_prosperity_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = prosperity }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_prosperity_revolt_active }
				remove_country_flag = cc_prosperity_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_prosperity_stage2_active }
				remove_country_flag = cc_prosperity_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_prosperity_stage3_active }
				remove_country_flag = cc_prosperity_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_prosperity }
				remove_modifier = cc_faction_stronghold_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_prosperity }
				remove_modifier = cc_faction_sympathies_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_prosperity }
				remove_modifier = cc_faction_sedition_prosperity
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_totalitarian_secondary_revolt_active
					has_country_flag = cc_totalitarian_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_totalitarian_secondary_revolt_active }
				remove_country_flag = cc_totalitarian_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = totalitarian }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_totalitarian_revolt_active }
				remove_country_flag = cc_totalitarian_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_totalitarian_stage2_active }
				remove_country_flag = cc_totalitarian_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_totalitarian_stage3_active }
				remove_country_flag = cc_totalitarian_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_totalitarian }
				remove_modifier = cc_faction_stronghold_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_totalitarian }
				remove_modifier = cc_faction_sympathies_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_totalitarian }
				remove_modifier = cc_faction_sedition_totalitarian
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_progressive_secondary_revolt_active
					has_country_flag = cc_progressive_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_progressive_secondary_revolt_active }
				remove_country_flag = cc_progressive_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = progressive }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_progressive_revolt_active }
				remove_country_flag = cc_progressive_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_progressive_stage2_active }
				remove_country_flag = cc_progressive_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_progressive_stage3_active }
				remove_country_flag = cc_progressive_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_progressive }
				remove_modifier = cc_faction_stronghold_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_progressive }
				remove_modifier = cc_faction_sympathies_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_progressive }
				remove_modifier = cc_faction_sedition_progressive
			}
		}
		every_owned_planet = {
			limit = { has_modifier = cc_faction_acute_unrest }
			remove_modifier = cc_faction_acute_unrest
		}
	}
	option = { name = CCGOOD2 }
}


#stage 3 fails (same as previous event, but different descs and trigger (need to work it out)
country_event = {
	id = ccfaction.42
	title = ccfaction.42.name
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = yes
			event_target:cc_rebellious_faction = { has_modifier = embraced_faction }
		}
		text = ccfaction.42.dual.succeed.desc
	}
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = no
			event_target:cc_rebellious_faction = { has_modifier = embraced_faction }
		}
		text = ccfaction.42.single.succeed.desc
	}
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = yes
			event_target:cc_rebellious_faction = { NOT = { has_modifier = embraced_faction } }
		}
		text = ccfaction.42.dual.fail.desc
	}
	desc = {
		trigger = {
			has_secondary_factional_revolt_active = no
			event_target:cc_rebellious_faction = { NOT = { has_modifier = embraced_faction } }
		}
		text = ccfaction.42.fail.succeed.desc
	}
	picture = GFX_evt_arguing_senate

	is_triggered_only = yes
	
	trigger = {
		NOR = {
			has_country_flag = cc_factional_revolt_succeeded
			has_country_flag = cc_factional_revolt_attempt
		}
	}
	
	immediate = {
		remove_modifier = cc_country_factional_unrest
		
		set_timed_country_flag = {
			flag = cc_revolt_ended_early
			days = 2000
		}
		
		if = {
			limit = {
				OR = {
					has_country_flag = cc_xenoist_secondary_revolt_active
					has_country_flag = cc_xenoist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_xenoist_secondary_revolt_active }
				remove_country_flag = cc_xenoist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = xenoist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_xenoist_revolt_active }
				remove_country_flag = cc_xenoist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_xenoist_stage2_active }
				remove_country_flag = cc_xenoist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_xenoist_stage3_active }
				remove_country_flag = cc_xenoist_stage3_active
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_xenoist }
				remove_modifier = cc_faction_stronghold_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_xenoist }
				remove_modifier = cc_faction_sympathies_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_xenoist }
				remove_modifier = cc_faction_sedition_xenoist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_isolationist_secondary_revolt_active
					has_country_flag = cc_isolationist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_isolationist_secondary_revolt_active }
				remove_country_flag = cc_isolationist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = isolationist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_isolationist_revolt_active }
				remove_country_flag = cc_isolationist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_isolationist_stage2_active }
				remove_country_flag = cc_isolationist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_isolationist_stage3_active }
				remove_country_flag = cc_isolationist_stage3_active
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_isolationist }
				remove_modifier = cc_faction_stronghold_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_isolationist }
				remove_modifier = cc_faction_sympathies_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_isolationist }
				remove_modifier = cc_faction_sedition_isolationist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_supremacist_secondary_revolt_active
					has_country_flag = cc_supremacist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_supremacist_secondary_revolt_active }
				remove_country_flag = cc_supremacist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = supremacist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_supremacist_revolt_active }
				remove_country_flag = cc_supremacist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_supremacist_stage2_active }
				remove_country_flag = cc_supremacist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_supremacist_stage3_active }
				remove_country_flag = cc_supremacist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_supremacist }
				remove_modifier = cc_faction_stronghold_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_supremacist }
				remove_modifier = cc_faction_sympathies_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_supremacist }
				remove_modifier = cc_faction_sedition_supremacist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_technologist_secondary_revolt_active
					has_country_flag = cc_technologist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_technologist_secondary_revolt_active }
				remove_country_flag = cc_technologist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = technologist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_technologist_revolt_active }
				remove_country_flag = cc_technologist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_technologist_stage2_active }
				remove_country_flag = cc_technologist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_technologist_stage3_active }
				remove_country_flag = cc_technologist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_technologist }
				remove_modifier = cc_faction_stronghold_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_technologist }
				remove_modifier = cc_faction_sympathies_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_technologist }
				remove_modifier = cc_faction_sedition_technologist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_traditionalist_secondary_revolt_active
					has_country_flag = cc_traditionalist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_traditionalist_secondary_revolt_active }
				remove_country_flag = cc_traditionalist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = traditionalist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_traditionalist_revolt_active }
				remove_country_flag = cc_traditionalist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_traditionalist_stage2_active }
				remove_country_flag = cc_traditionalist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_traditionalist_stage3_active }
				remove_country_flag = cc_traditionalist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_traditionalist }
				remove_modifier = cc_faction_stronghold_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_traditionalist }
				remove_modifier = cc_faction_sympathies_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_traditionalist }
				remove_modifier = cc_faction_sedition_traditionalist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_imperialist_secondary_revolt_active
					has_country_flag = cc_imperialist_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_imperialist_secondary_revolt_active }
				remove_country_flag = cc_imperialist_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = imperialist }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_imperialist_revolt_active }
				remove_country_flag = cc_imperialist_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_imperialist_stage2_active }
				remove_country_flag = cc_imperialist_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_imperialist_stage3_active }
				remove_country_flag = cc_imperialist_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_imperialist }
				remove_modifier = cc_faction_stronghold_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_imperialist }
				remove_modifier = cc_faction_sympathies_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_imperialist }
				remove_modifier = cc_faction_sedition_imperialist
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_prosperity_secondary_revolt_active
					has_country_flag = cc_prosperity_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_prosperity_secondary_revolt_active }
				remove_country_flag = cc_prosperity_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = prosperity }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_prosperity_revolt_active }
				remove_country_flag = cc_prosperity_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_prosperity_stage2_active }
				remove_country_flag = cc_prosperity_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_prosperity_stage3_active }
				remove_country_flag = cc_prosperity_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_prosperity }
				remove_modifier = cc_faction_stronghold_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_prosperity }
				remove_modifier = cc_faction_sympathies_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_prosperity }
				remove_modifier = cc_faction_sedition_prosperity
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_totalitarian_secondary_revolt_active
					has_country_flag = cc_totalitarian_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_totalitarian_secondary_revolt_active }
				remove_country_flag = cc_totalitarian_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = totalitarian }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_totalitarian_revolt_active }
				remove_country_flag = cc_totalitarian_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_totalitarian_stage2_active }
				remove_country_flag = cc_totalitarian_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_totalitarian_stage3_active }
				remove_country_flag = cc_totalitarian_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_totalitarian }
				remove_modifier = cc_faction_stronghold_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_totalitarian }
				remove_modifier = cc_faction_sympathies_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_totalitarian }
				remove_modifier = cc_faction_sedition_totalitarian
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = cc_progressive_secondary_revolt_active
					has_country_flag = cc_progressive_revolt_active
				}
			}	
			if = {
				limit = { has_country_flag = cc_progressive_secondary_revolt_active }
				remove_country_flag = cc_progressive_secondary_revolt_active
				random_pop_faction = {
					limit = { is_pop_faction_type = progressive }
					save_event_target_as = cc_new_reb_faction
				}
			}
			if = {
				limit = { has_country_flag = cc_progressive_revolt_active }
				remove_country_flag = cc_progressive_secondary_revolt_active
			}
			if = {
				limit = { has_country_flag = cc_progressive_stage2_active }
				remove_country_flag = cc_progressive_stage2_active
			}
			if = {
				limit = { has_country_flag = cc_progressive_stage3_active }
				remove_country_flag = cc_progressive_stage3_active
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_progressive }
				remove_modifier = cc_faction_stronghold_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_progressive }
				remove_modifier = cc_faction_sympathies_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_progressive }
				remove_modifier = cc_faction_sedition_progressive
			}
		}
		every_owned_planet = {
			limit = { has_modifier = cc_faction_acute_unrest }
			remove_modifier = cc_faction_acute_unrest
		}
	}
	option = { name = CCGOOD2 }
}




#add proper localisations
#Factional Revolt Begins (needs a planet willing to revolt)
country_event = {
	id = ccfaction.6
	title = ccfaction.6.name
	desc = {
		text = ccfaction.6.desc.succeed
		trigger = {
			has_country_flag = cc_factional_revolt_succeeded
			NOT = { exists = event_target:cc_rebellious_faction_leader }
		}
	}
	desc = {
		text = ccfaction.6.desc.succeed.leader
		trigger = {
			has_country_flag = cc_factional_revolt_succeeded
			exists = event_target:cc_rebellious_faction_leader
		}
	}
	desc = {
		text = ccfaction.6.desc.attempt
		trigger = { has_country_flag = cc_factional_revolt_attempt }
	}
	
	picture = {
		picture = GFX_evt_arguing_senate
		trigger = { has_country_flag = cc_factional_revolt_succeeded }
	}
	
	picture = {
		picture = GFX_evt_ground_combat
		trigger = { has_country_flag = cc_factional_revolt_attempt }
	}
	
	trigger = {
		has_factional_revolt_stage3 = yes
		NOR = {
			has_country_flag = cc_factional_revolt_attempt
			has_country_flag = cc_factional_revolt_succeeded
		}
		any_owned_planet = {
			is_faction_stronghold = yes
			unrest > 80
			has_ground_combat = no
			controller = { is_same_value = root }
			has_modifier = cc_faction_acute_unrest
		}
	}
	
	mean_time_to_happen = {
		days = 800
		modifier = {
			factor = 0.75
			any_owned_planet = {
				is_faction_stronghold = yes
				unrest > 99
				has_ground_combat = no
				controller = { is_same_value = root }
				has_modifier = cc_faction_acute_unrest
			}
		}
		modifier = {
			factor = 0.75
			any_owned_planet = {
				is_faction_stronghold = yes
				unrest > 80
				has_ground_combat = no
				controller = { is_same_value = root }
				has_modifier = cc_faction_acute_unrest
				
				root = {
					any_owned_planet = {
						NOT = { is_same_value = prevprev }
						is_faction_stronghold = yes
						unrest > 80
						has_ground_combat = no
						controller = { is_same_value = root }
						has_modifier = cc_faction_acute_unrest
					}
				}
			}
		}
		modifier = {
			factor = 0.75
			any_owned_planet = {
				is_faction_stronghold = yes
				unrest > 80
				has_ground_combat = no
				controller = { is_same_value = root }
				has_modifier = cc_faction_acute_unrest
				
				root = {
					any_owned_planet = {
						NOT = { is_same_value = prevprev }
						is_faction_stronghold = yes
						unrest > 80
						has_ground_combat = no
						controller = { is_same_value = root }
						has_modifier = cc_faction_acute_unrest
						
						root = {
							any_owned_planet = {
								NOR = {
									is_same_value = prevprev
									is_same_value = prevprevprevprev
								}
								is_faction_stronghold = yes
								unrest > 80
								has_ground_combat = no
								controller = { is_same_value = root }
								has_modifier = cc_faction_acute_unrest
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
		#save factions as event targets
		if = {
			limit = { has_country_flag = cc_imperialist_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = imperialist }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_prosperity_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = prosperity }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_totalitarian_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = totalitarian }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_progressive_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = progressive }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_technologist_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = technologist }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_traditionalist_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = traditionalist }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_xenoist_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = xenoist }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_supremacist_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = supremacist }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_isolationist_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = isolationist }
				save_event_target_as = cc_rebellious_faction
				
				leader = { save_event_target_as = cc_rebellious_faction_leader }
			}
		}
		
		#Secondary Faction
		if = {
			limit = { has_country_flag = cc_imperialist_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = imperialist }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_prosperity_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = prosperity }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_totalitarian_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = totalitarian }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_progressive_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = progressive }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_technologist_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = technologist }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_traditionalist_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = traditionalist }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_xenoist_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = xenoist }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_supremacist_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = supremacist }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		if = {
			limit = { has_country_flag = cc_isolationist_secondary_revolt_active }
			random_pop_faction = {
				limit = { is_pop_faction_type = isolationist }
				save_event_target_as = cc_new_reb_faction
				
				leader = { save_event_target_as = cc_new_reb_faction_leader }
			}
		}
		
		if = {
			limit = {
				any_owned_planet = {
					is_faction_stronghold = yes
					unrest > 99
					has_ground_combat = no
					controller = { is_same_value = root }
					has_modifier = cc_faction_acute_unrest
				}
			}
			
			set_timed_country_flag = {
				flag = cc_factional_revolt_succeeded
				years = 10
			}
			
			#create country, swap owner, get other planets to swap.
			create_country = {
				name = random
				type = default
				species = root.species
				ignore_initial_colony_error = yes
				day_zero_contact = no
				flag = random
				effect = {
					#primary ethic
					if = {
						limit = { root = { has_country_flag = cc_imperialist_revolt_active } }
						country_add_ethic = ethic_fanatic_militarist
					}
					if = {
						limit = { root = { has_country_flag = cc_prosperity_revolt_active } }
						country_add_ethic = ethic_fanatic_pacifist
					}
					if = {
						limit = { root = { has_country_flag = cc_totalitarian_revolt_active } }
						country_add_ethic = ethic_fanatic_authoritarian
					}
					if = {
						limit = { root = { has_country_flag = cc_progressive_revolt_active } }
						country_add_ethic = ethic_fanatic_egalitarian
					}
					if = {
						limit = { root = { has_country_flag = cc_technologist_revolt_active } }
						country_add_ethic = ethic_fanatic_materialist
					}
					if = {
						limit = { root = { has_country_flag = cc_traditionalist_revolt_active } }
						country_add_ethic = ethic_fanatic_spiritualist
					}
					if = {
						limit = { root = { has_country_flag = cc_xenoist_revolt_active } }
						country_add_ethic = ethic_fanatic_xenophile
					}
					if = {
						limit = {
							root = {
								OR = {
									has_country_flag = cc_supremacist_revolt_active
									has_country_flag = cc_isolationist_revolt_active
								}
							}
						}
						country_add_ethic = ethic_fanatic_xenophobe
					}
					
					#secondary ethic
					if = {
						limit = { root = { has_country_flag = cc_imperialist_secondary_revolt_active } }
						country_add_ethic = ethic_militarist
					}
					if = {
						limit = { root = { has_country_flag = cc_prosperity_secondary_revolt_active } }
						country_add_ethic = ethic_pacifist
					}
					if = {
						limit = { root = { has_country_flag = cc_totalitarian_secondary_revolt_active } }
						country_add_ethic = ethic_authoritarian
					}
					if = {
						limit = { root = { has_country_flag = cc_progressive_secondary_revolt_active } }
						country_add_ethic = ethic_egalitarian
					}
					if = {
						limit = { root = { has_country_flag = cc_technologist_secondary_revolt_active } }
						country_add_ethic = ethic_materialist
					}
					if = {
						limit = { root = { has_country_flag = cc_traditionalist_secondary_revolt_active } }
						country_add_ethic = ethic_spiritualist
					}
					if = {
						limit = { root = { has_country_flag = cc_xenoist_secondary_revolt_active } }
						country_add_ethic = ethic_xenophile
					}
					if = {
						limit = {
							root = {
								OR = {
									has_country_flag = cc_supremacist_secondary_revolt_active
									has_country_flag = cc_isolationist_secondary_revolt_active
								}
							}
							NOT = { has_ethic = ethic_fanatic_xenophobe }
						}
						country_add_ethic = ethic_xenophobe
					}
					
					if = {
						limit = { num_ethics = 1 }
						random_list = {
							1 = {
								country_add_ethic = ethic_authoritarian
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										has_ethic = ethic_fanatic_egalitarian
										root = {
											OR = {
												has_ethic = ethic_fanatic_authoritarian
												has_ethic = ethic_authoritarian
											}
										}
									}
								}
							}
							1 = {
								country_add_ethic = ethic_egalitarian
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										has_ethic = ethic_fanatic_egalitarian
										root = {
											OR = {
												has_ethic = ethic_fanatic_egalitarian
												has_ethic = ethic_egalitarian
											}
										}
									}
								}
							}
							1 = {
								country_add_ethic = ethic_xenophile
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_xenophile
										has_ethic = ethic_fanatic_xenophobe
										root = {
											OR = {
												has_ethic = ethic_fanatic_xenophile
												has_ethic = ethic_xenophile
											}
										}
									}
								}
							}
							1 = {
								country_add_ethic = ethic_xenophobe
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_xenophile
										has_ethic = ethic_fanatic_xenophobe
										root = {
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_xenophobe
											}
										}
									}
								}
							}
							1 = {
								country_add_ethic = ethic_spiritualist
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_spiritualist
										has_ethic = ethic_fanatic_materialist
										root = {
											OR = {
												has_ethic = ethic_fanatic_spiritualist
												has_ethic = ethic_spiritualist
											}
										}
									}
								}
							}
							1 = {
								country_add_ethic = ethic_materialist
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_spiritualist
										has_ethic = ethic_fanatic_materialist
										root = {
											OR = {
												has_ethic = ethic_fanatic_materialist
												has_ethic = ethic_materialist
											}
										}
									}
								}
							}
							1 = {
								country_add_ethic = ethic_militarist
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_pacifist
										has_ethic = ethic_fanatic_militarist
										root = {
											OR = {
												has_ethic = ethic_fanatic_militarist
												has_ethic = ethic_militarist
											}
										}
									}
								}
							}
							1 = {
								country_add_ethic = ethic_pacifist
								
								modifier = {
									factor = 0
									OR = {
										has_ethic = ethic_fanatic_pacifist
										has_ethic = ethic_fanatic_militarist
										root = {
											OR = {
												has_ethic = ethic_fanatic_pacifist
												has_ethic = ethic_pacifist
											}
										}
									}
								}
							}
						}
					}
					
					change_government = {
						authority = random
						civics = random
					}
					
					set_name = random
						
				
					save_event_target_as = cc_breakaway_country
							
					set_timed_relation_flag = {
						who = root
						flag = cc_breakaway_country
						years = 10
					}
					
					if = {
						limit = { exists = event_target:cc_rebellious_faction_leader }
						event_target:cc_rebellious_faction_leader = { exile_leader_as = cc_rebellious_faction_leader }
						set_leader = cc_rebellious_faction_leader
					}
					
					create_fleet_from_naval_cap = 1
				}
			}
			

			random_owned_planet = {
				limit = {
					is_faction_stronghold = yes
					unrest > 99
					has_ground_combat = no
					controller = { is_same_value = root }
					has_modifier = cc_faction_acute_unrest
				}
				save_event_target_as = cc_rebel_faction_capital
				
				set_owner = event_target:cc_breakaway_country
				
				remove_modifier = cc_faction_acute_unrest
				if = {
					limit = { has_modifier = cc_faction_stronghold_xenoist }
					remove_modifier = cc_faction_stronghold_xenoist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_isolationist }
					remove_modifier = cc_faction_stronghold_isolationist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_supremacist }
					remove_modifier = cc_faction_stronghold_supremacist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_totalitarian }
					remove_modifier = cc_faction_stronghold_totalitarian
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_progressive }
					remove_modifier = cc_faction_stronghold_progressive
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_technologist }
					remove_modifier = cc_faction_stronghold_technologist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_traditionalist }
					remove_modifier = cc_faction_stronghold_traditionalist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_imperialist }
					remove_modifier = cc_faction_stronghold_imperialist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_prosperity }
					remove_modifier = cc_faction_stronghold_prosperity
				}
			}
			
			every_owned_planet = { #swap the firm planets
				limit = {
					NOT = { is_same_value = event_target:cc_rebel_faction_capital }
					controller = { is_same_value = root }
					is_faction_stronghold = yes
					unrest > 80
					has_ground_combat = no
				}
				planet_event = { id = ccfaction.61 days = 20 random 15 }
			}
			
			every_owned_planet = { #revolts in the others
				limit = {
					NOT = { is_same_value = event_target:cc_rebel_faction_capital }
					controller = { is_same_value = root }
					is_faction_stronghold = yes
					NOT = { unrest > 80 }
					has_ground_combat = no
				}
				planet_event = { id = ccfaction.62 days = 20 random 15 }
			}
			
			country_event = { id = ccfaction.7 days = 15 }
			
			else = {
				set_country_flag = cc_factional_revolt_attempt
					
				random_owned_planet = {
					limit = {
						is_faction_stronghold = yes
						unrest > 80
						has_ground_combat = no
						controller = { is_same_value = root }
						has_modifier = cc_faction_acute_unrest
					}
				
				
					set_planet_flag = revolt_in_progress
					
					#create rebels
					
					create_rebels = {
						name = random
						species = root.species
						flag = random
					
						effect = {
						
							set_country_flag = cc_faction_rebels
							establish_communications_no_message = root
							root = {
								every_relation = {
									establish_communications_no_message = prevprevprev
								}
							}
							
							
							#primary ethic
							if = {
								limit = { root = { has_country_flag = cc_imperialist_revolt_active } }
								country_add_ethic = ethic_fanatic_militarist
							}
							if = {
								limit = { root = { has_country_flag = cc_prosperity_revolt_active } }
								country_add_ethic = ethic_fanatic_pacifist
							}
							if = {
								limit = { root = { has_country_flag = cc_totalitarian_revolt_active } }
								country_add_ethic = ethic_fanatic_authoritarian
							}
							if = {
								limit = { root = { has_country_flag = cc_progressive_revolt_active } }
								country_add_ethic = ethic_fanatic_egalitarian
							}
							if = {
								limit = { root = { has_country_flag = cc_technologist_revolt_active } }
								country_add_ethic = ethic_fanatic_materialist
							}
							if = {
								limit = { root = { has_country_flag = cc_traditionalist_revolt_active } }
								country_add_ethic = ethic_fanatic_spiritualist
							}
							if = {
								limit = { root = { has_country_flag = cc_xenoist_revolt_active } }
								country_add_ethic = ethic_fanatic_xenophile
							}
							if = {
								limit = {
									root = {
										OR = {
											has_country_flag = cc_supremacist_revolt_active
											has_country_flag = cc_isolationist_revolt_active
										}
									}
								}
								country_add_ethic = ethic_fanatic_xenophobe
							}
							
							#secondary ethic
							if = {
								limit = { root = { has_country_flag = cc_imperialist_secondary_revolt_active } }
								country_add_ethic = ethic_militarist
							}
							if = {
								limit = { root = { has_country_flag = cc_prosperity_secondary_revolt_active } }
								country_add_ethic = ethic_pacifist
							}
							if = {
								limit = { root = { has_country_flag = cc_totalitarian_secondary_revolt_active } }
								country_add_ethic = ethic_authoritarian
							}
							if = {
								limit = { root = { has_country_flag = cc_progressive_secondary_revolt_active } }
								country_add_ethic = ethic_egalitarian
							}
							if = {
								limit = { root = { has_country_flag = cc_technologist_secondary_revolt_active } }
								country_add_ethic = ethic_materialist
							}
							if = {
								limit = { root = { has_country_flag = cc_traditionalist_secondary_revolt_active } }
								country_add_ethic = ethic_spiritualist
							}
							if = {
								limit = { root = { has_country_flag = cc_xenoist_secondary_revolt_active } }
								country_add_ethic = ethic_xenophile
							}
							if = {
								limit = {
									root = {
										OR = {
											has_country_flag = cc_supremacist_secondary_revolt_active
											has_country_flag = cc_isolationist_secondary_revolt_active
										}
									}
									NOT = { has_ethic = ethic_fanatic_xenophobe }
								}
								country_add_ethic = ethic_xenophobe
							}
							
							if = {
								limit = { num_ethics = 1 }
								random_list = {
									1 = {
										country_add_ethic = ethic_authoritarian
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_authoritarian
												has_ethic = ethic_fanatic_egalitarian
												root = {
													OR = {
														has_ethic = ethic_fanatic_authoritarian
														has_ethic = ethic_authoritarian
													}
												}
											}
										}
									}
									1 = {
										country_add_ethic = ethic_egalitarian
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_authoritarian
												has_ethic = ethic_fanatic_egalitarian
												root = {
													OR = {
														has_ethic = ethic_fanatic_egalitarian
														has_ethic = ethic_egalitarian
													}
												}
											}
										}
									}
									1 = {
										country_add_ethic = ethic_xenophile
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_xenophile
												has_ethic = ethic_fanatic_xenophobe
												root = {
													OR = {
														has_ethic = ethic_fanatic_xenophile
														has_ethic = ethic_xenophile
													}
												}
											}
										}
									}
									1 = {
										country_add_ethic = ethic_xenophobe
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_xenophile
												has_ethic = ethic_fanatic_xenophobe
												root = {
													OR = {
														has_ethic = ethic_fanatic_xenophobe
														has_ethic = ethic_xenophobe
													}
												}
											}
										}
									}
									1 = {
										country_add_ethic = ethic_spiritualist
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_spiritualist
												has_ethic = ethic_fanatic_materialist
												root = {
													OR = {
														has_ethic = ethic_fanatic_spiritualist
														has_ethic = ethic_spiritualist
													}
												}
											}
										}
									}
									1 = {
										country_add_ethic = ethic_materialist
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_spiritualist
												has_ethic = ethic_fanatic_materialist
												root = {
													OR = {
														has_ethic = ethic_fanatic_materialist
														has_ethic = ethic_materialist
													}
												}
											}
										}
									}
									1 = {
										country_add_ethic = ethic_militarist
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_pacifist
												has_ethic = ethic_fanatic_militarist
												root = {
													OR = {
														has_ethic = ethic_fanatic_militarist
														has_ethic = ethic_militarist
													}
												}
											}
										}
									}
									1 = {
										country_add_ethic = ethic_pacifist
										
										modifier = {
											factor = 0
											OR = {
												has_ethic = ethic_fanatic_pacifist
												has_ethic = ethic_fanatic_militarist
												root = {
													OR = {
														has_ethic = ethic_fanatic_pacifist
														has_ethic = ethic_pacifist
													}
												}
											}
										}
									}
								}
							}
							
							change_government = {
								authority = random
								civics = random
							}
							
							set_name = random
								
						
							save_event_target_as = cc_breakaway_country
									
							set_timed_relation_flag = {
								who = root
								flag = cc_breakaway_country
								years = 10
							}
							
							if = {
								limit = { exists = event_target:cc_rebellious_faction_leader }
								event_target:cc_rebellious_faction_leader = { exile_leader_as = cc_rebellious_faction_leader }
								set_leader = cc_rebellious_faction_leader
							}
						}
					}
				
				
					every_owned_pop = {
						limit = {
							OR = {
								if = {
									limit = { root = { has_country_flag = cc_imperialist_revolt_active } }
									member_of_faction = imperialist
								}
								if = {
									limit = { root = { has_country_flag = cc_prosperity_revolt_active } }
									member_of_faction = prosperity
								}
								if = {
									limit = { root = { has_country_flag = cc_totalitarian_revolt_active } }
									member_of_faction = totalitarian
								}
								if = {
									limit = { root = { has_country_flag = cc_progressive_revolt_active } }
									member_of_faction = progressive
								}
								if = {
									limit = { root = { has_country_flag = cc_technologist_revolt_active } }
									member_of_faction = technologist
								}
								if = {
									limit = { root = { has_country_flag = cc_traditionalist_revolt_active } }
									member_of_faction = traditionalist
								}
								if = {
									limit = { root = { has_country_flag = cc_xenoist_revolt_active } }
									member_of_faction = xenoist
								}
								if = {
									limit = { root = { has_country_flag = cc_supremacist_revolt_active } }
									member_of_faction = supremacist
								}
								if = {
									limit = { root = { has_country_flag = cc_isolationist_revolt_active } }
									member_of_faction = isolationist
								}
								
								if = {
									limit = { root = { has_country_flag = cc_imperialist_secondary_revolt_active } }
									member_of_faction = imperialist
								}
								if = {
									limit = { root = { has_country_flag = cc_prosperity_secondary_revolt_active } }
									member_of_faction = prosperity
								}
								if = {
									limit = { root = { has_country_flag = cc_totalitarian_secondary_revolt_active } }
									member_of_faction = totalitarian
								}
								if = {
									limit = { root = { has_country_flag = cc_progressive_secondary_revolt_active } }
									member_of_faction = progressive
								}
								if = {
									limit = { root = { has_country_flag = cc_technologist_secondary_revolt_active } }
									member_of_faction = technologist
								}
								if = {
									limit = { root = { has_country_flag = cc_traditionalist_secondary_revolt_active } }
									member_of_faction = traditionalist
								}
								if = {
									limit = { root = { has_country_flag = cc_xenoist_secondary_revolt_active } }
									member_of_faction = xenoist
								}
								if = {
									limit = { root = { has_country_flag = cc_supremacist_secondary_revolt_active } }
									member_of_faction = supremacist
								}
								if = {
									limit = { root = { has_country_flag = cc_isolationist_secondary_revolt_active } }
									member_of_faction = isolationist
								}
							}
						}
						planet = {
							while = {
								count = 3
								create_army = {
									owner = event_target:cc_breakaway_country
									species = root.species
									type = "defense_army"
								}
							}
						}
					}
					
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 720
					}
					set_timed_planet_flag = {
						flag = cc_faction_revolt_capital
						days = 720
					}
				}
			}
		}
	}
	
	option = {
		name = unfortunate
	}
}


#swap owners on high unrest planets
planet_event = {
	id = ccfaction.61
	title = ccfaction.61.name
	desc = ccfaction.61.desc
	
	#maybe I will make a better picture sometime
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes
	
	immediate = {
		set_owner = event_target:cc_breakaway_country

		if = {
			limit = { has_modifier = cc_faction_acute_unrest }
			remove_modifier = cc_faction_acute_unrest
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_xenoist }
			remove_modifier = cc_faction_stronghold_xenoist
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_isolationist }
			remove_modifier = cc_faction_stronghold_isolationist
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_supremacist }
			remove_modifier = cc_faction_stronghold_supremacist
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_totalitarian }
			remove_modifier = cc_faction_stronghold_totalitarian
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_progressive }
			remove_modifier = cc_faction_stronghold_progressive
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_technologist }
			remove_modifier = cc_faction_stronghold_technologist
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_traditionalist }
			remove_modifier = cc_faction_stronghold_traditionalist
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_imperialist }
			remove_modifier = cc_faction_stronghold_imperialist
		}
		if = {
			limit = { has_modifier = cc_faction_stronghold_prosperity }
			remove_modifier = cc_faction_stronghold_prosperity
		}

		owner = {
			if = {
				limit = { num_owned_planets < 4 }
					
				if = {
					limit = { root = { num_pops < 13 NOT = { num_pops < 7 } } }
					
					create_fleet_from_naval_cap = 0.16
					last_created_fleet = {
						set_location = root
					}
								
					else = {
						if = {
							limit = { root = { num_pops < 19 NOT = { num_pops < 7 } } }
							
							create_fleet_from_naval_cap = 0.32
							last_created_fleet = {
								set_location = root
							}
					
							else = {
								if = {
									limit = { NOT = { num_pops < 7 } }
									create_fleet_from_naval_cap = 0.48
									last_created_fleet = {
										set_location = root
									}
								}
							}
						}
					}
				}
									
				else = {
					if = {
						limit = {
							num_owned_planets < 6
						}
						if = {
							limit = { root = { num_pops < 13 NOT = { num_pops < 7 } } }
							
							create_fleet_from_naval_cap = 0.09
							last_created_fleet = {
								set_location = root
							}
							
							else = {
								if = {
									limit = { root = { num_pops < 19 NOT = { num_pops < 7 } } }
									
									create_fleet_from_naval_cap = 0.18
									last_created_fleet = {
										set_location = root
									}
							
									else = {
										if = {
											limit = { NOT = { num_pops < 7 } }
											create_fleet_from_naval_cap = 0.28
											last_created_fleet = {
												set_location = root
											}
										}
									}
								}
							}
						}
						else = {
							if = {
								limit = { root = { num_pops < 13 NOT = { num_pops < 7 } } }
								
								create_fleet_from_naval_cap = 0.04
								last_created_fleet = {
									set_location = root
								}
								
								else = {
									if = {
										limit = { root = { num_pops < 19 NOT = { num_pops < 7 } } }
										
										create_fleet_from_naval_cap = 0.08
										last_created_fleet = {
											set_location = root
										}
								
										else = {
											if = {
												limit = { NOT = { num_pops < 7 } }
												create_fleet_from_naval_cap = 0.12
												last_created_fleet = {
													set_location = root
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	option = { name = UNFORTUNATE }
}



#organised rebellion on low-unrest planets
planet_event = {
	id = ccfaction.62
	title = ccfaction.62.name
	desc = ccfaction.62.desc
	
	picture = GFX_evt_ground_combat
	
	is_triggered_only = yes
	
	immediate = {
		set_timed_planet_flag = {
			flag = cc_revolution
			days = 60
		}

		set_planet_flag = revolt_in_progress
		
		#create rebels
		
		create_rebels = {
			ethos = event_target:cc_breakaway_country
			authority = event_target:cc_breakaway_country
			#civics = event_target:cc_breakaway_country
			civics = random
			species = event_target:cc_breakaway_country
			flag = random
			effect = {
				set_country_flag = cc_faction_rebels_second_wave
				save_event_target_as = cc_faction_rebels
				establish_communications_no_message = root.owner
				establish_communications_no_message = event_target:cc_breakaway_country
				root = {
					owner = {
						every_relation = {
							establish_communications_no_message = prevprevprev
						}
					}
				}
			}
		}
	
	
		every_owned_pop = {
			limit = {
				OR = {
					if = {
						limit = { root.owner = { has_country_flag = cc_imperialist_revolt_active } }
						member_of_faction = imperialist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_prosperity_revolt_active } }
						member_of_faction = prosperity
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_totalitarian_revolt_active } }
						member_of_faction = totalitarian
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_progressive_revolt_active } }
						member_of_faction = progressive
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_technologist_revolt_active } }
						member_of_faction = technologist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_traditionalist_revolt_active } }
						member_of_faction = traditionalist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_xenoist_revolt_active } }
						member_of_faction = xenoist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_supremacist_revolt_active } }
						member_of_faction = supremacist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_isolationist_revolt_active } }
						member_of_faction = isolationist
					}
					
					if = {
						limit = { root.owner = { has_country_flag = cc_imperialist_secondary_revolt_active } }
						member_of_faction = imperialist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_prosperity_secondary_revolt_active } }
						member_of_faction = prosperity
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_totalitarian_secondary_revolt_active } }
						member_of_faction = totalitarian
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_progressive_secondary_revolt_active } }
						member_of_faction = progressive
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_technologist_secondary_revolt_active } }
						member_of_faction = technologist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_traditionalist_secondary_revolt_active } }
						member_of_faction = traditionalist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_xenoist_secondary_revolt_active } }
						member_of_faction = xenoist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_supremacist_secondary_revolt_active } }
						member_of_faction = supremacist
					}
					if = {
						limit = { root.owner = { has_country_flag = cc_isolationist_secondary_revolt_active } }
						member_of_faction = isolationist
					}
				}
			}
			planet = {
				while = {
					count = 3
					create_army = {
						owner = event_target:cc_breakaway_country
						species = event_target:cc_breakaway_country
						type = "defense_army"
					}
				}
			}
		}
		
		set_timed_planet_flag = {
			flag = recent_unrest_event
			days = 720
		}
		set_timed_planet_flag = {
			flag = cc_faction_revolt_planet
			days = 720
		}
	}
	option = { name = UNFORTUNATE }
}



#Rebellion of first wave succeeds

# Initial rebels manage to take control of the planet, happens before the new owner is set, after the war is created.
# This = Rebel Country
# From = Planet
# FromFrom = War
country_event = {
	id = ccfaction.63
	hide_window = yes
	is_triggered_only = yes

	trigger = { has_country_flag = cc_faction_rebels }

	immediate = {
		save_event_target_as = cc_breakaway_country
		
		From = { 
			remove_planet_flag = revolt_in_progress 
			remove_planet_flag = cc_faction_revolt_capital
			save_event_target_as = cc_rebel_faction_capital
		}
		from.owner = {
			remove_country_flag = cc_factional_revolt_attempt
			set_timed_country_flag = {
				flag = cc_factional_revolt_succeeded
				years = 10
			}
			
			
			every_owned_planet = { #swap the firm planets
				limit = {
					NOT = { is_same_value = from }
					controller = { is_same_value = prev }
					is_faction_stronghold = yes
					unrest > 80
					has_ground_combat = no
				}
				planet_event = { id = ccfaction.61 days = 20 random 15 }
			}
			
			every_owned_planet = { #revolts in the others
				limit = {
					NOT = { is_same_value = from }
					controller = { is_same_value = prev }
					is_faction_stronghold = yes
					NOT = { unrest > 80 }
					has_ground_combat = no
				}
				planet_event = { id = ccfaction.62 days = 20 random 15 }
			}
			
			
			save_event_target_as = rebelled_against
			country_event = { id = ccfaction.64 days = 3 }
			country_event = { id = ccfaction.7 days = 15 }
		}
		from = { 
			if = {
				limit = { has_modifier = cc_faction_acute_unrest }
				remove_modifier = cc_faction_acute_unrest
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_xenoist }
				remove_modifier = cc_faction_stronghold_xenoist
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_isolationist }
				remove_modifier = cc_faction_stronghold_isolationist
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_supremacist }
				remove_modifier = cc_faction_stronghold_supremacist
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_totalitarian }
				remove_modifier = cc_faction_stronghold_totalitarian
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_progressive }
				remove_modifier = cc_faction_stronghold_progressive
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_technologist }
				remove_modifier = cc_faction_stronghold_technologist
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_traditionalist }
				remove_modifier = cc_faction_stronghold_traditionalist
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_imperialist }
				remove_modifier = cc_faction_stronghold_imperialist
			}
			if = {
				limit = { has_modifier = cc_faction_stronghold_prosperity }
				remove_modifier = cc_faction_stronghold_prosperity
			}
		}
		if = {
			limit = { NOT = { has_global_flag = potent_rebellions_expanded_active } }
			create_fleet_from_naval_cap = 1
		}
	}
}
	
#Notify root.owner

country_event = { # rebels have broken free notification
	id = ccfaction.64
	title = ccfaction.64.name
	desc = ccfaction.64.desc
	picture = GFX_evt_arguing_senate
	
	show_sound = event_factions
	location = fromfrom

	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}


#Rebellion of second wave succeeds

# Initial rebels manage to take control of the planet, happens before the new owner is set, after the war is created.
# This = Rebel Country
# From = Planet
# FromFrom = War
country_event = {
	id = ccfaction.66
	hide_window = yes
	is_triggered_only = yes

	trigger = { has_country_flag = cc_faction_rebels_second_wave }
	
	immediate = {
		From = { 
			remove_planet_flag = revolt_in_progress 
			remove_planet_flag = cc_faction_revolt_planet
			save_event_target_as = cc_rebel_faction_capital
		}
		from.owner = {
			save_event_target_as = rebelled_against
			country_event = { id = ccfaction.67 days = 3 }
		}
		from = { 
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_xenoist }
					remove_modifier = cc_faction_stronghold_xenoist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_isolationist }
					remove_modifier = cc_faction_stronghold_isolationist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_supremacist }
					remove_modifier = cc_faction_stronghold_supremacist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_totalitarian }
					remove_modifier = cc_faction_stronghold_totalitarian
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_progressive }
					remove_modifier = cc_faction_stronghold_progressive
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_technologist }
					remove_modifier = cc_faction_stronghold_technologist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_traditionalist }
					remove_modifier = cc_faction_stronghold_traditionalist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_imperialist }
					remove_modifier = cc_faction_stronghold_imperialist
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_prosperity }
					remove_modifier = cc_faction_stronghold_prosperity
				}
		}
		
		from.owner = {
			if = {
				limit = {
					any_country = {
						NOT = { is_same_value = root.owner } #just in case
						has_relation_flag = {
							who = prev
							flag = cc_breakaway_country
						}
					}
				}
				random_country = {
					limit = {
						NOT = { is_same_value = root.owner } #just in case
						has_relation_flag = {
							who = prev
							flag = cc_breakaway_country
						}
					}
					country_event = { id = ccfaction.69 days = 3 }
				}
			}
		}							
	}
}


#Notify root.owner

country_event = { # rebels have broken free notification
	id = ccfaction.67
	title = ccfaction.67.name
	desc = ccfaction.67.desc
	picture = GFX_evt_arguing_senate
	
	show_sound = event_factions
	location = fromfrom

	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}


#Rebellion of either wave fails

# This = country, planet owner
# From = country, attack leader
# FromFrom = planet

# Revolt Suppressed #
country_event = {
	id = ccfaction.68
	title = ccfaction.68.name
	desc = ccfaction.68.desc
	
	picture = GFX_evt_alien_propaganda
	
	show_sound = event_celebration
	location = FromFrom

	trigger = {
		is_country_type = default
		FromFrom = {
			has_planet_flag = revolt_in_progress
			controller = { is_same_value = root }
			OR = {
				has_planet_flag = cc_faction_revolt_planet
				has_planet_flag = cc_faction_revolt_capital
			}
		}
	}

	is_triggered_only = yes

	immediate = {
		FromFrom = {
			remove_planet_flag = revolt_in_progress
			if = {
				limit = { has_planet_flag = cc_faction_revolt_planet }
				remove_planet_flag = cc_faction_revolt_planet
			}
			if = {
				limit = { has_planet_flag = cc_faction_revolt_capital }
				remove_planet_flag = cc_faction_revolt_capital
			}
		}
		
		if = {
			limit = { has_country_flag = cc_factional_revolt_attempt }
			remove_country_flag = cc_factional_revolt_attempt
			
			if = {
				limit = { has_factional_revolt_stage3 = no }
				country_event = { id = ccfaction.42 }
			}
		}
	}

	option = { #Vanilla name and tooltips are fine
		name = unrest.4235.a
		FromFrom = { 
			add_modifier = {
				modifier = cc_failed_factional_revolt
				days = 3600
			}
			if = {
				limit = { has_modifier = cc_faction_acute_unrest }
				remove_modifier = cc_faction_acute_unrest
			}
		}
		custom_tooltip = unrest.161.a.tooltip
	}
}


#Planet Transferred (use for sympathisers too) (made a separate event for the sake of spaceport modules)

country_event = {
	id = ccfaction.69
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = root
		exists = from
		NOT = { root = { is_same_value = from } }
	}
	
	immediate = {
			
		fromfrom = { 
			if = {
				limit = {
					has_spaceport = yes
					OR = {
						num_spaceport_modules = 6
						is_spaceport_module_slot_free = 6
					}
				}
				random_list = {
					1 = {
						modifier = {
							factor = 0
							NOT = { root = { has_technology = tech_mass_drivers_1 } }
						}
						set_timed_planet_flag = {
							flag = ccrebel_spaceport_6_k
							days = 3
						}
					}
					1 = {
						modifier = {
							factor = 0
							NOT = { root = { has_technology = tech_missiles_1 } }
						}
						set_timed_planet_flag = {
							flag = ccrebel_spaceport_6_m
							days = 3
						}
					}
					1 = {
						modifier = {
							factor = 0
							NOT = { root = { has_technology = tech_lasers_1 } }
						}
						set_timed_planet_flag = {
							flag = ccrebel_spaceport_6_l
							days = 3
						}
					}
				}
				else = {
					if = {
						limit = {
							has_spaceport = yes
							OR = {
								num_spaceport_modules = 5
								is_spaceport_module_slot_free = 5
							}
						}
						random_list = {
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_mass_drivers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_5_k
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_missiles_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_5_m
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_lasers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_5_l
									days = 3
								}
							}
						}
				else = {
					if = {
						limit = {
							has_spaceport = yes
							OR = {
								num_spaceport_modules = 4
								is_spaceport_module_slot_free = 4
							}
						}
						random_list = {
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_mass_drivers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_4_k
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_missiles_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_4_m
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_lasers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_4_l
									days = 3
								}
							}
						}
				else = {
					if = {
						limit = {
							has_spaceport = yes
							OR = {
								num_spaceport_modules = 3
								is_spaceport_module_slot_free = 3
							}
						}
						random_list = {
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_mass_drivers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_3_k
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_missiles_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_3_m
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_lasers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_3_l
									days = 3
								}
							}
						}
				else = {
					if = {
						limit = {
							has_spaceport = yes
							OR = {
								num_spaceport_modules = 2
								is_spaceport_module_slot_free = 2
							}
						}
						random_list = {
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_mass_drivers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_2_k
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_missiles_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_2_m
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_lasers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_2_l
									days = 3
								}
							}
						}
				else = {
					if = {
						limit = {
							has_spaceport = yes
							OR = {
								num_spaceport_modules = 1
								is_spaceport_module_slot_free = 1
							}
						}
						random_list = {
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_mass_drivers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_1_k
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_missiles_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_1_m
									days = 3
								}
							}
							1 = {
								modifier = {
									factor = 0
									NOT = { root = { has_technology = tech_lasers_1 } }
								}
								set_timed_planet_flag = {
									flag = ccrebel_spaceport_1_l
									days = 3
								}
							}
						}
					}
				}
					}
				}
					}
				}
					}
				}
					}
				}
			}
			#modules
			if = {
				limit = { has_spaceport = yes }
				if = {
					limit = { has_spaceport_module = solar_panel_network }
					set_timed_planet_flag = {
						flag = ccrebel_sm_solar
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = crew_quarters }
					set_timed_planet_flag = {
						flag = ccrebel_sm_crew
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = observatory }
					set_timed_planet_flag = {
						flag = ccrebel_sm_observatory
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = engineering_bay }
					set_timed_planet_flag = {
						flag = ccrebel_sm_engineering_bay
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = hydroponic_farms }
					set_timed_planet_flag = {
						flag = ccrebel_sm_hydroponic_farms
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = synchronized_defenses }
					set_timed_planet_flag = {
						flag = ccrebel_sm_synchronized_defenses
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = corvette_assembly_yards }
					set_timed_planet_flag = {
						flag = ccrebel_sm_corvette_assembly_yards
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = destroyer_assembly_yards }
					set_timed_planet_flag = {
						flag = ccrebel_sm_destroyer_assembly_yards
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = fleet_academy }
					set_timed_planet_flag = {
						flag = ccrebel_sm_fleet_academy
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = orbital_mind_control_laser }
					set_timed_planet_flag = {
						flag = ccrebel_sm_orbital_mind_control_laser
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = cruiser_assembly_yards }
					set_timed_planet_flag = {
						flag = ccrebel_sm_cruiser_assembly_yards
						days = 3
					}
				}
				if = {
					limit = { has_spaceport_module = battleship_assembly_yards }
					set_timed_planet_flag = {
						flag = ccrebel_sm_battleship_assembly_yards
						days = 3
					}
				}
				planet_event = { id = rebellionscript.777 days = 2 }
			}
		}
			
		from = {
			set_country_flag = silence_destroy_event
			destroy_country = yes
		}
		fromfrom = {
			set_owner = root
			hidden_effect = {
				if = {
					limit = { has_modifier = capital }
					remove_modifier = capital
				}
			}
		}
		country_event = { id = ccfaction.691 days = 2 }
	}
}



country_event = {
	id = ccfaction.691
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { NOT = { has_global_flag = potent_rebellions_expanded_active } }
	
	immediate = {
		if = {
			limit = { num_owned_planets < 4 }
		
			if = {
				limit = { root = { num_pops < 13 NOT = { num_pops < 7 } } }
				
				create_fleet_from_naval_cap = 0.16
				last_created_fleet = {
					set_location = root
				}
				
				else = {
					if = {
						limit = { root = { num_pops < 19 NOT = { num_pops < 7 } } }
						
						create_fleet_from_naval_cap = 0.32
						last_created_fleet = {
							set_location = root
						}
				
						else = {
							if = {
								limit = { NOT = { num_pops < 7 } }
								create_fleet_from_naval_cap = 0.48
								last_created_fleet = {
									set_location = root
								}
							}
						}
					}
				}
			}
		
			else = {
				if = {
					limit = {
						num_owned_planets < 6
					}
					if = {
						limit = { root = { num_pops < 13 NOT = { num_pops < 7 } } }
						
						create_fleet_from_naval_cap = 0.09
						last_created_fleet = {
							set_location = root
						}
						
						else = {
							if = {
								limit = { root = { num_pops < 19 NOT = { num_pops < 7 } } }
								
								create_fleet_from_naval_cap = 0.18
								last_created_fleet = {
									set_location = root
								}
						
								else = {
									if = {
										limit = { NOT = { num_pops < 7 } }
										create_fleet_from_naval_cap = 0.28
										last_created_fleet = {
											set_location = root
										}
									}
								}
							}
						}
					}
					else = {
						if = {
							limit = { root = { num_pops < 13 NOT = { num_pops < 7 } } }
							
							create_fleet_from_naval_cap = 0.04
							last_created_fleet = {
								set_location = root
							}
								
							else = {
								if = {
									limit = { root = { num_pops < 19 NOT = { num_pops < 7 } } }
									
									create_fleet_from_naval_cap = 0.08
									last_created_fleet = {
										set_location = root
									}
						
									else = {
										if = {
											limit = { NOT = { num_pops < 7 } }
											create_fleet_from_naval_cap = 0.12
											last_created_fleet = {
												set_location = root
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}
				



#All that's left is 'sympathy planets'. Option of CCKILLALL if you are a purifier, fanatic authoritarian,
#authoritarian-fanatic xenophobe/militarist, or authoritarian-xenophobe-militarist. Option of CCOPPRESS (?) if you
#are not fanatic egalitarian (or was it also not egalitarian?). Otherwise, subsidise (all the planets get -75%
#income for 5 years, and big governing ethics attraction) or ignore.


country_event = {
	id = ccfaction.7
	title = ccfaction.7.name
	desc = ccfaction.7.desc
	
	picture = GFX_evt_arguing_senate
	
	is_triggered_only = yes
	
	trigger = { any_owned_planet = { has_faction_sympathies = yes } }
	
	immediate = {
		every_owned_planet = {
			limit = { has_faction_sympathies = yes }
			
			add_modifier = {
				modifier = cc_breakaway_sympathy
				days = -1
			}
			set_timed_planet_flag = {
				flag = recent_unrest_event
				years = 7
			}
		}
	}
	option = {
		name = CCKILLALL
		custom_tooltip = ccfaction.7.A.tooltip
		
		every_owned_planet = {
			limit = { has_faction_sympathies = yes }
			remove_modifier = cc_breakaway_sympathy
			#the faction sympathy modifier will go automatically
				

			hidden_effect = {
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_imperialist_revolt_active
								has_country_flag = cc_imperialist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_militarist }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_prosperity_revolt_active
								has_country_flag = cc_prosperity_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_pacifist }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_totalitarian_revolt_active
								has_country_flag = cc_totalitarian_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_authoritarian }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_progressive_revolt_active
								has_country_flag = cc_progressive_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_egalitarian }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_technologist_revolt_active
								has_country_flag = cc_technologist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_materialist }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_traditionalist_revolt_active
								has_country_flag = cc_traditionalist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_spiritualist }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_xenoist_revolt_active
								has_country_flag = cc_xenoist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_xenophile }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_supremacist_revolt_active
								has_country_flag = cc_isolationist_revolt_active
								has_country_flag = cc_supremacist_secondary_revolt_active
								has_country_flag = cc_isolationist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_xenophobe }
						
						every_country = {
							limit = {
								has_communications = root
								NOT = { is_country = root }
								NOT = { has_ai_personality_behaviour = purger }
								NOT = {
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										AND = {
											has_ethic = ethic_authoritarian
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_fanatic_militarist
												AND = {
													has_ethic = ethic_xenophobe
													has_ethic = ethic_militarist
												}
											}
										}
									}
								}
								OR = {
									is_country_type = default
									has_ai_personality = awakened_fallen_empire_xenophile				
								}	
							}
							add_opinion_modifier = { who = root modifier = opinion_genocidal }
						}
						
						kill_pop = yes
					}
				}
			}
		}
		
		add_modifier = {
			modifier = cc_empire_terror
			years = 10
		}
		
		if = {
			limit = {
				NOR = {
					has_country_flag = cc_progressive_revolt_active
					has_country_flag = cc_progressive_secondary_revolt_active
				}
				has_faction = progressive
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = progressive }
				add_modifier = {
					modifier = cc_empire_terror_faction
					years = 10
				}
			}
		}
		
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				OR = {
					has_ethic = ethic_fanatic_authoritarian
					has_valid_civic = civic_fanatic_purifiers
				}
			}
			modifier = {
				factor = 0.35
				any_relation = {
					has_communications = root
					NOT = { is_country = root }
					NOT = { has_ai_personality_behaviour = purger }
					NOT = {
						OR = {
							has_ethic = ethic_fanatic_authoritarian
							AND = {
								has_ethic = ethic_authoritarian
								OR = {
									has_ethic = ethic_fanatic_xenophobe
									has_ethic = ethic_fanatic_militarist
									AND = {
										has_ethic = ethic_xenophobe
										has_ethic = ethic_militarist
									}
								}
							}
						}
					}
					OR = {
						is_country_type = default
						has_ai_personality = awakened_fallen_empire_xenophile				
					}
					OR = {
						has_defensive_pact = root
						is_in_federation_with = root
					}
				}
			}
		}
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_ethic = ethic_fanatic_authoritarian
				AND = {
					has_ethic = ethic_authoritarian
					OR = {
						has_ethic = ethic_fanatic_xenophobe
						has_ethic = ethic_fanatic_militarist
						AND = {
							has_ethic = ethic_xenophobe
							has_ethic = ethic_militarist
						}
					}
				}
			}
		}
	}
	option = {
		name = CCOPPRESS
		
		every_owned_planet = {
			limit = { has_faction_sympathies = yes }
			add_modifier = {
				modifier = cc_planet_oppression
				years = 10
			}
			hidden_effect = {
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_imperialist_revolt_active
								has_country_flag = cc_imperialist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_militarist }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_prosperity_revolt_active
								has_country_flag = cc_prosperity_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_pacifist }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_totalitarian_revolt_active
								has_country_flag = cc_totalitarian_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_authoritarian }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_progressive_revolt_active
								has_country_flag = cc_progressive_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_egalitarian }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_technologist_revolt_active
								has_country_flag = cc_technologist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_materialist }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_traditionalist_revolt_active
								has_country_flag = cc_traditionalist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_spiritualist }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_xenoist_revolt_active
								has_country_flag = cc_xenoist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_xenophile }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
				if = {
					limit = {
						root = {
							OR = {
								has_country_flag = cc_supremacist_revolt_active
								has_country_flag = cc_isolationist_revolt_active
								has_country_flag = cc_supremacist_secondary_revolt_active
								has_country_flag = cc_isolationist_secondary_revolt_active
							}
						}
					}
					every_owned_pop = {
						limit = { has_ethic = ethic_xenophobe }
						add_modifier = {
							modifier = cc_oppression
							years = 10
						}
					}
				}
			}
		}
		custom_tooltip = ccfaction.7.B.tooltip
		
		if = {
			limit = {
				NOR = {
					has_country_flag = cc_progressive_revolt_active
					has_country_flag = cc_progressive_secondary_revolt_active
				}
				has_faction = progressive
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = progressive }
				add_modifier = {
					modifier = cc_oppress_faction
					years = 10
				}
			}
		}
		
		trigger = {
			NOR = {
				has_ethic = ethic_egalitarian
				has_ethic = ethic_fanatic_egalitarian
			}
		}
		
		ai_chance = {
			factor = 5
			modifier = {
				factor = 1.5
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
			}
		}
	}
	option = { #subsidise
		name = ccfaction.7.C
		custom_tooltip = ccfaction.7.C.tooltip
		
		every_owned_planet = {
			limit = { has_faction_sympathies = yes }
			add_modifier = {
				modifier = cc_bribed_planet
				years = 10
			}
		}
		
		ai_chance = {
			factor = 5
			modifier = {
				factor = 0.75
				has_monthly_income = { resource = minerals value < 50 }
			}
			modifier = {
				factor = 0.5
				has_monthly_income = { resource = energy value < 5 }
			}
			modifier = {
				factor = 0.5
				is_at_war = yes
				has_monthly_income = { resource = energy value < -50 }
			}
			
			modifier = {
				factor = 0.35
				OR = {
					has_valid_civic = civic_fanatic_purifiers
					has_ethic = ethic_fanatic_authoritarian
					AND = {
						has_ethic = ethic_authoritarian
						OR = {
							has_ethic = ethic_fanatic_xenophobe
							has_ethic = ethic_fanatic_militarist
							AND = {
								has_ethic = ethic_xenophobe
								has_ethic = ethic_militarist
							}
						}
					}
				}
			}
		}
	}
	option = {
		name = ccfaction.7.D
		
		ai_chance = { factor = 1.5 }
	}
}


#MTTH event for sympathy revolts? Surely needed


#end of factional unrest (expires 15 years after started)
country_event = {
	id = ccfaction.900
	title = ccfaction.900.name
	desc = {
		trigger = { exists = event_target:cc_breakaway_country }
		text = ccfaction.900.exists.desc
	}
	desc = {
		trigger = { NOT = { exists = event_target:cc_breakaway_country } }
		text = ccfaction.900.doesnotexist.desc
	}
	
	picture = GFX_evt_arguing_senate

	is_triggered_only = yes
	
	trigger = { NOT = { has_country_flag = cc_revolt_ended_early } }
	
	immediate = {
		if = {
			limit = {
				any_country = {
					has_relation_flag = {
						who = root
						flag = cc_breakaway_country
					}
				}
			}
			random_country = {
				limit = {
					has_relation_flag = {
						who = root
						flag = cc_breakaway_country
					}
				}
				save_event_target_as = cc_breakaway_country
			}
		}
	}
	
	option = {
		name = CCGOOD
		
		remove_modifier = cc_country_factional_unrest
		
			every_owned_planet = {
				limit = { has_modifier = cc_breakaway_sympathy }
				remove_modifier = cc_breakaway_sympathy
			}
		
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_xenoist }
				remove_modifier = cc_faction_stronghold_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_xenoist }
				remove_modifier = cc_faction_sympathies_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_xenoist }
				remove_modifier = cc_faction_sedition_xenoist
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_isolationist }
				remove_modifier = cc_faction_stronghold_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_isolationist }
				remove_modifier = cc_faction_sympathies_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_isolationist }
				remove_modifier = cc_faction_sedition_isolationist
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_supremacist }
				remove_modifier = cc_faction_stronghold_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_supremacist }
				remove_modifier = cc_faction_sympathies_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_supremacist }
				remove_modifier = cc_faction_sedition_supremacist
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_technologist }
				remove_modifier = cc_faction_stronghold_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_technologist }
				remove_modifier = cc_faction_sympathies_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_technologist }
				remove_modifier = cc_faction_sedition_technologist
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_traditionalist }
				remove_modifier = cc_faction_stronghold_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_traditionalist }
				remove_modifier = cc_faction_sympathies_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_traditionalist }
				remove_modifier = cc_faction_sedition_traditionalist
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_imperialist }
				remove_modifier = cc_faction_stronghold_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_imperialist }
				remove_modifier = cc_faction_sympathies_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_imperialist }
				remove_modifier = cc_faction_sedition_imperialist
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_prosperity }
				remove_modifier = cc_faction_stronghold_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_prosperity }
				remove_modifier = cc_faction_sympathies_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_prosperity }
				remove_modifier = cc_faction_sedition_prosperity
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_totalitarian }
				remove_modifier = cc_faction_stronghold_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_totalitarian }
				remove_modifier = cc_faction_sympathies_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_totalitarian }
				remove_modifier = cc_faction_sedition_totalitarian
			}
			
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_progressive }
				remove_modifier = cc_faction_stronghold_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_progressive }
				remove_modifier = cc_faction_sympathies_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_progressive }
				remove_modifier = cc_faction_sedition_progressive
			}

		every_owned_planet = {
			limit = { has_modifier = cc_faction_acute_unrest }
			remove_modifier = cc_faction_acute_unrest
		}
	}
}

	

#monthly, all-purpose cleanup event
event = {
	id = ccfaction.999
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
	
		#get rid of sympathies stuff
		every_country = {
			limit = {
				any_owned_planet = { has_modifier = cc_breakaway_sympathy }
				NOT = {
					AND = {
						has_factional_revolt_stage3 = yes
						any_country = {
							has_relation_flag = {
								who = prev
								flag = cc_breakaway_country
							}
						}
					}
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_breakaway_sympathy }
				remove_modifier = cc_breakaway_sympathy
			}
		}
	
		#remove the seditious talk if you conquer a planet
		every_country = {
			limit = { NOT = { has_country_flag = cc_xenoist_seditions_active } }
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_xenophile }
				remove_modifier = cc_seditious_talk_xenophile
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_supremacist_seditions_active
					has_country_flag = cc_isolationist_seditions_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_xenophobe }
				remove_modifier = cc_seditious_talk_xenophobe
			}
		}
		every_country = {
			limit = { NOT = { has_country_flag = cc_traditionalist_seditions_active } }
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_spiritualist }
				remove_modifier = cc_seditious_talk_spiritualist
			}
		}
		every_country = {
			limit = { NOT = { has_country_flag = cc_technologist_seditions_active } }
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_materialist }
				remove_modifier = cc_seditious_talk_materialist
			}
		}
		every_country = {
			limit = { NOT = { has_country_flag = cc_imperialist_seditions_active } }
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_militarist }
				remove_modifier = cc_seditious_talk_militarist
			}
		}
		every_country = {
			limit = { NOT = { has_country_flag = cc_prosperity_seditions_active } }
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_pacifist }
				remove_modifier = cc_seditious_talk_pacifist
			}
		}
		every_country = {
			limit = { NOT = { has_country_flag = cc_totalitarian_seditions_active } }
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_authoritarian }
				remove_modifier = cc_seditious_talk_authoritarian
			}
		}
		every_country = {
			limit = { NOT = { has_country_flag = cc_progressive_seditions_active } }
			every_owned_planet = {
				limit = { has_modifier = cc_seditious_talk_egalitarian }
				remove_modifier = cc_seditious_talk_egalitarian
			}
		}
		
		#remove the stronghold/sympathies/sedition modifiers
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_xenoist_stage2_active
					has_country_flag = cc_xenoist_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_xenoist }
				remove_modifier = cc_faction_stronghold_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_xenoist }
				remove_modifier = cc_faction_stronghold_xenoist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_xenoist }
				remove_modifier = cc_faction_stronghold_xenoist
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_traditionalist_stage2_active
					has_country_flag = cc_traditionalist_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_traditionalist }
				remove_modifier = cc_faction_stronghold_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_traditionalist }
				remove_modifier = cc_faction_stronghold_traditionalist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_traditionalist }
				remove_modifier = cc_faction_stronghold_traditionalist
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_supremacist_stage2_active
					has_country_flag = cc_supremacist_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_supremacist }
				remove_modifier = cc_faction_stronghold_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_supremacist }
				remove_modifier = cc_faction_stronghold_supremacist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_supremacist }
				remove_modifier = cc_faction_stronghold_supremacist
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_isolationist_stage2_active
					has_country_flag = cc_isolationist_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_isolationist }
				remove_modifier = cc_faction_stronghold_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_isolationist }
				remove_modifier = cc_faction_stronghold_isolationist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_isolationist }
				remove_modifier = cc_faction_stronghold_isolationist
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_totalitarian_stage2_active
					has_country_flag = cc_totalitarian_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_totalitarian }
				remove_modifier = cc_faction_stronghold_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_totalitarian }
				remove_modifier = cc_faction_stronghold_totalitarian
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_totalitarian }
				remove_modifier = cc_faction_stronghold_totalitarian
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_progressive_stage2_active
					has_country_flag = cc_progressive_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_progressive }
				remove_modifier = cc_faction_stronghold_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_progressive }
				remove_modifier = cc_faction_stronghold_progressive
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_progressive }
				remove_modifier = cc_faction_stronghold_progressive
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_imperialist_stage2_active
					has_country_flag = cc_imperialist_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_imperialist }
				remove_modifier = cc_faction_stronghold_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_imperialist }
				remove_modifier = cc_faction_stronghold_imperialist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_imperialist }
				remove_modifier = cc_faction_stronghold_imperialist
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_prosperity_stage2_active
					has_country_flag = cc_prosperity_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_prosperity }
				remove_modifier = cc_faction_stronghold_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_prosperity }
				remove_modifier = cc_faction_stronghold_prosperity
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_prosperity }
				remove_modifier = cc_faction_stronghold_prosperity
			}
		}
		every_country = {
			limit = {
				NOR = {
					has_country_flag = cc_technologist_stage2_active
					has_country_flag = cc_technologist_stage3_active
				}
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_stronghold_technologist }
				remove_modifier = cc_faction_stronghold_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sympathies_technologist }
				remove_modifier = cc_faction_stronghold_technologist
			}
			every_owned_planet = {
				limit = { has_modifier = cc_faction_sedition_technologist }
				remove_modifier = cc_faction_stronghold_technologist
			}
		}
		
		
		#increase chance of faction re-evaluation
		every_country = {
			limit = { has_modifier = cc_country_factional_unrest }
			every_owned_planet = {
				limit = { 
					OR = {
						has_seditious_talk = yes
						is_faction_stronghold = yes
						has_faction_sympathies = yes
						has_faction_sedition = yes
					}
				}
				
				every_owned_pop = {
					pop_event = { id = ccfaction.9991 }
				}
			}
		}
		
		
		
		#refresh planets in stage 1
		every_country = {
			limit = { has_country_flag = cc_xenoist_seditions_active }
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_xenophile
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophile }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_xenophile }
						}
					}
				}
				remove_modifier = cc_seditious_talk_xenophile
			}
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_seditious_talk_xenophile }
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophile }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_xenophile }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_xenophile
					days = -1
				}
			}
		}

		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_isolationist_seditions_active
					has_country_flag = cc_supremacist_seditions_active
				}
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_xenophobe
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				remove_modifier = cc_seditious_talk_xenophobe
			}
			every_owned_planet = {
				limit = {
					NOR = {
						has_modifier = cc_seditious_talk_xenophobe
						has_modifier = cc_faction_sedition_isolationist
						has_modifier = cc_faction_sympathies_isolationist
						has_modifier = cc_faction_stronghold_isolationist
						has_modifier = cc_faction_sedition_supremacist
						has_modifier = cc_faction_sympathies_supremacist
						has_modifier = cc_faction_stronghold_supremacist
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_xenophobe
					days = -1
				}
			}
		}

		every_country = {
			limit = { has_country_flag = cc_traditionalist_seditions_active }
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_spiritualist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_spiritualist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_spiritualist }
						}
					}
				}
				remove_modifier = cc_seditious_talk_spiritualist
			}
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_seditious_talk_spiritualist }
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_spiritualist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_spiritualist }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_spiritualist
					days = -1
				}
			}
		}

		every_country = {
			limit = { has_country_flag = cc_technologist_seditions_active }
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_materialist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_materialist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_materialist }
						}
					}
				}
				remove_modifier = cc_seditious_talk_materialist
			}
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_seditious_talk_materialist }
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_materialist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_materialist }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_materialist
					days = -1
				}
			}
		}

		every_country = {
			limit = { has_country_flag = cc_totalitarian_seditions_active }
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_authoritarian
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_authoritarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_authoritarian }
						}
					}
				}
				remove_modifier = cc_seditious_talk_authoritarian
			}
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_seditious_talk_authoritarian }
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_authoritarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_authoritarian }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_authoritarian
					days = -1
				}
			}
		}

		every_country = {
			limit = { has_country_flag = cc_progressive_seditions_active }
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_egalitarian
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_egalitarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_egalitarian }
						}
					}
				}
				remove_modifier = cc_seditious_talk_egalitarian
			}
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_seditious_talk_egalitarian }
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_egalitarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_egalitarian }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_egalitarian
					days = -1
				}
			}
		}

		every_country = {
			limit = { has_country_flag = cc_imperialist_seditions_active }
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_militarist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_militarist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_militarist }
						}
					}
				}
				remove_modifier = cc_seditious_talk_militarist
			}
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_seditious_talk_militarist }
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_militarist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_militarist }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_militarist
					days = -1
				}
			}
		}

		every_country = {
			limit = { has_country_flag = cc_prosperity_seditions_active }
			every_owned_planet = {
				limit = {
					has_modifier = cc_seditious_talk_pacifist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_pacifist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_pacifist }
						}
					}
				}
				remove_modifier = cc_seditious_talk_pacifist
			}
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_seditious_talk_pacifist }
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_pacifist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.24
							limit = { has_ethic = ethic_pacifist }
						}
					}
				}
				add_modifier = {
					modifier = cc_seditious_talk_pacifist
					days = -1
				}
			}
		}
		
		
	#refresh planets in stages 2 and 3
		#xenoist
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_xenoist_stage2_active
					has_country_flag = cc_xenoist_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = xenoist }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_xenoist
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = xenoist }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_xenoist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_xenoist
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_xenoist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_xenoist
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_xenoist }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = xenoist }
						}
					}
					OR = {
						count_pops = {
							limit = {  has_ethic = ethic_xenophile }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophile }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_xenoist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_xenoist }
					remove_modifier = cc_faction_stronghold_xenoist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_xenoist }
					remove_modifier = cc_faction_sedition_xenoist
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_xenoist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophile }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophile }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_xenoist
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_xenoist }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = xenoist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_xenoist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_xenoist }
					remove_modifier = cc_faction_sympathies_xenoist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_xenoist }
					remove_modifier = cc_faction_sedition_xenoist
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_xenoist_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_xenoist
								has_modifier = cc_faction_sympathies_xenoist
								has_modifier = cc_faction_sedition_xenoist
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_xenoist
							days = -1
						}
					}
				}
			}
		}
		
		#isolationist
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_isolationist_stage2_active
					has_country_flag = cc_isolationist_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = isolationist }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_isolationist
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = isolationist }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_isolationist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_isolationist
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_isolationist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_isolationist
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_isolationist }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = isolationist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_isolationist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_isolationist }
					remove_modifier = cc_faction_stronghold_isolationist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_isolationist }
					remove_modifier = cc_faction_sedition_isolationist
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_isolationist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_isolationist
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_isolationist }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = isolationist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_isolationist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_isolationist }
					remove_modifier = cc_faction_sympathies_isolationist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_isolationist }
					remove_modifier = cc_faction_sedition_isolationist
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_isolationist_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_isolationist
								has_modifier = cc_faction_sympathies_isolationist
								has_modifier = cc_faction_sedition_isolationist
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_isolationist
							days = -1
						}
					}
				}
			}
		}
		
		#supremacist
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_supremacist_stage2_active
					has_country_flag = cc_supremacist_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = supremacist }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_supremacist
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = supremacist }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_supremacist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_supremacist
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_supremacist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_supremacist
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_supremacist }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = supremacist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_supremacist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_supremacist }
					remove_modifier = cc_faction_stronghold_supremacist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_supremacist }
					remove_modifier = cc_faction_sedition_supremacist
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_supremacist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_xenophobe }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_xenophobe }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_supremacist
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_supremacist }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = supremacist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_supremacist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_supremacist }
					remove_modifier = cc_faction_sympathies_supremacist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_supremacist }
					remove_modifier = cc_faction_sedition_supremacist
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_supremacist_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_supremacist
								has_modifier = cc_faction_sympathies_supremacist
								has_modifier = cc_faction_sedition_supremacist
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_supremacist
							days = -1
						}
					}
				}
			}
		}
		
		#traditionalist
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_traditionalist_stage2_active
					has_country_flag = cc_traditionalist_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = traditionalist }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_traditionalist
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = traditionalist }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_traditionalist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_traditionalist
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_traditionalist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_traditionalist
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_traditionalist }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = traditionalist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_spiritualist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_spiritualist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_traditionalist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_traditionalist }
					remove_modifier = cc_faction_stronghold_traditionalist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_traditionalist }
					remove_modifier = cc_faction_sedition_traditionalist
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_traditionalist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_spiritualist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_spiritualist }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_traditionalist
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_traditionalist }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = traditionalist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_traditionalist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_traditionalist }
					remove_modifier = cc_faction_sympathies_traditionalist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_traditionalist }
					remove_modifier = cc_faction_sedition_traditionalist
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_traditionalist_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_traditionalist
								has_modifier = cc_faction_sympathies_traditionalist
								has_modifier = cc_faction_sedition_traditionalist
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_traditionalist
							days = -1
						}
					}
				}
			}
		}
		
		#technologist
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_technologist_stage2_active
					has_country_flag = cc_technologist_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = technologist }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_technologist
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = technologist }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_technologist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_technologist
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_technologist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_technologist
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_technologist }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = technologist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_materialist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_materialist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_technologist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_technologist }
					remove_modifier = cc_faction_stronghold_technologist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_technologist }
					remove_modifier = cc_faction_sedition_technologist
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_technologist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_materialist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_materialist }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_technologist
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_technologist }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = technologist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_technologist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_technologist }
					remove_modifier = cc_faction_sympathies_technologist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_technologist }
					remove_modifier = cc_faction_sedition_technologist
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_technologist_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_technologist
								has_modifier = cc_faction_sympathies_technologist
								has_modifier = cc_faction_sedition_technologist
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_technologist
							days = -1
						}
					}
				}
			}
		}
		
		#progressive
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_progressive_stage2_active
					has_country_flag = cc_progressive_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = progressive }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_progressive
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = progressive }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_progressive
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_progressive
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_progressive
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_progressive
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_progressive }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = progressive }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_egalitarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_egalitarian }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_progressive
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_progressive }
					remove_modifier = cc_faction_stronghold_progressive
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_progressive }
					remove_modifier = cc_faction_sedition_progressive
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_progressive
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_egalitarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_egalitarian }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_progressive
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_progressive }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = progressive }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_progressive
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_progressive }
					remove_modifier = cc_faction_sympathies_progressive
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_progressive }
					remove_modifier = cc_faction_sedition_progressive
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_progressive_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_progressive
								has_modifier = cc_faction_sympathies_progressive
								has_modifier = cc_faction_sedition_progressive
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_progressive
							days = -1
						}
					}
				}
			}
		}
		
		#totalitarian
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_totalitarian_stage2_active
					has_country_flag = cc_totalitarian_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = totalitarian }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_totalitarian
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = totalitarian }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_totalitarian
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_totalitarian
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_totalitarian
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_totalitarian
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_totalitarian }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = totalitarian }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_authoritarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_authoritarian }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_totalitarian
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_totalitarian }
					remove_modifier = cc_faction_stronghold_totalitarian
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_totalitarian }
					remove_modifier = cc_faction_sedition_totalitarian
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_totalitarian
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_authoritarian }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_authoritarian }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_totalitarian
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_totalitarian }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = totalitarian }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_totalitarian
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_totalitarian }
					remove_modifier = cc_faction_sympathies_totalitarian
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_totalitarian }
					remove_modifier = cc_faction_sedition_totalitarian
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_totalitarian_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_totalitarian
								has_modifier = cc_faction_sympathies_totalitarian
								has_modifier = cc_faction_sedition_totalitarian
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_totalitarian
							days = -1
						}
					}
				}
			}
		}
		
		#imperialist
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_imperialist_stage2_active
					has_country_flag = cc_imperialist_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = imperialist }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_imperialist
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = imperialist }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_imperialist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_imperialist
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_imperialist
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_imperialist
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_imperialist }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = imperialist }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_militarist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_militarist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_imperialist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_imperialist }
					remove_modifier = cc_faction_stronghold_imperialist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_imperialist }
					remove_modifier = cc_faction_sedition_imperialist
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_imperialist
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_militarist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_militarist }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_imperialist
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_imperialist }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = imperialist }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_imperialist
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_imperialist }
					remove_modifier = cc_faction_sympathies_imperialist
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_imperialist }
					remove_modifier = cc_faction_sedition_imperialist
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_imperialist_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_imperialist
								has_modifier = cc_faction_sympathies_imperialist
								has_modifier = cc_faction_sedition_imperialist
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_imperialist
							days = -1
						}
					}
				}
			}
		}
		
		#prosperity
		every_country = {
			limit = {
				OR = {
					has_country_flag = cc_prosperity_stage2_active
					has_country_flag = cc_prosperity_stage3_active
				}
			}
			random_pop_faction = {
				limit = { is_pop_faction_type = prosperity }
				save_event_target_as = cc_rebellious_faction
			}
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_stronghold_prosperity
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = prosperity }
						}
					}
				}
				remove_modifier = cc_faction_stronghold_prosperity
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9993 }
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sedition_prosperity
					NOT = {
						owner = {
							any_owned_planet = {
								has_modifier = cc_faction_stronghold_prosperity
								distance = {
									source = prevprev
									min_distance = 0
									max_distance = 65
								}
							}
						}
					}
				}
				remove_modifier = cc_faction_sedition_prosperity
			}
			
			
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_sympathies_prosperity }
					NOT = {
						pop_percentage = {
							percentage > 0.25
							limit = { member_of_faction = prosperity }
						}
					}
					OR = {
						count_pops = {
							limit = { has_ethic = ethic_pacifist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_pacifist }
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_prosperity
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_stronghold_prosperity }
					remove_modifier = cc_faction_stronghold_prosperity
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_prosperity }
					remove_modifier = cc_faction_sedition_prosperity
				}
			}
			
			every_owned_planet = {
				limit = {
					has_modifier = cc_faction_sympathies_prosperity
					NOR = {
						count_pops = {
							limit = { has_ethic = ethic_pacifist }
							count > 3
						}
						pop_percentage = {
							percentage > 0.2
							limit = { has_ethic = ethic_pacifist }
						}
					}
				}
				remove_modifier = cc_faction_sympathies_prosperity
			}
					
			every_owned_planet = {
				limit = {
					NOT = { has_modifier = cc_faction_stronghold_prosperity }
					pop_percentage = {
						percentage > 0.25
						limit = { member_of_faction = prosperity }
					}
				}
				add_modifier = {
					modifier = cc_faction_stronghold_prosperity
					days = -1
				}
				if = {
					limit = { has_modifier = cc_faction_sympathies_prosperity }
					remove_modifier = cc_faction_sympathies_prosperity
				}
				if = {
					limit = { has_modifier = cc_faction_sedition_prosperity }
					remove_modifier = cc_faction_sedition_prosperity
				}
				if = {
					limit = {
						NOT = { has_modifier = cc_faction_acute_unrest }
						owner = { has_country_flag = cc_prosperity_stage3_active }
					}
					add_modifier = {
						modifier = cc_faction_acute_unrest
						days = 540
					}
					set_timed_planet_flag = {
						flag = recent_unrest_event
						days = 540
					}
				}
				if = {
					limit = { owner = { is_ai = no } }
					planet_event = { id = ccfaction.9994 }
				}
					
				owner = {
					every_owned_planet = {
						limit = {
							NOR = {
								has_modifier = cc_faction_stronghold_prosperity
								has_modifier = cc_faction_sympathies_prosperity
								has_modifier = cc_faction_sedition_prosperity
							}
							distance = {
								source = prevprev
								min_distance = 0
								max_distance = 65
							}
						}
						add_modifier = {
							modifier = cc_faction_sedition_prosperity
							days = -1
						}
					}
				}
			}
		}
	}
}

pop_event = {
	id = ccfaction.9991
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random = {
			chance = 5
			force_faction_evaluation = yes
		}
	}
}

#other one not quite all-purpose. This one on_bi_yearly_pulse
#event = {
#	id = ccfaction.9992
#	hide_window = yes
#	is_triggered_only = yes
#	
#	immediate = {
#	}
#}

#Notification to make it more transparent to the player
planet_event = {
	id = ccfaction.9993
	title = ccfaction.9993.name
	desc = ccfaction.9993.desc
	picture = GFX_evt_alien_propaganda
	
	is_triggered_only = yes
	
	option = {
		name = CCGOOD

		tooltip = {
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = xenoist } }
				
				remove_modifier = cc_faction_stronghold_xenoist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophile }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophile }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_xenoist
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = supremacist } }
				
				remove_modifier = cc_faction_stronghold_supremacist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophobe }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_supremacist
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = isolationist } }
				
				remove_modifier = cc_faction_stronghold_isolationist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_xenophobe }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_xenophobe }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_isolationist
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = traditionalist } }
				
				remove_modifier = cc_faction_stronghold_traditionalist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_spiritualist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_spiritualist }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_traditionalist
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = technologist } }
				
				remove_modifier = cc_faction_stronghold_technologist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_materialist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_materialist }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_technologist
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = totalitarian } }
				
				remove_modifier = cc_faction_stronghold_totalitarian
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_authoritarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_authoritarian }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_totalitarian
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = progressive } }
				
				remove_modifier = cc_faction_stronghold_progressive
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_egalitarian }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_egalitarian }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_progressive
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = imperialist } }
				
				remove_modifier = cc_faction_stronghold_imperialist
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_militarist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_militarist }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_imperialist
					days = -1
				}
			}
			
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = prosperity } }
				
				remove_modifier = cc_faction_stronghold_prosperity
				if = {
					limit = { has_modifier = cc_faction_acute_unrest }
					remove_modifier = cc_faction_acute_unrest
				}
				if = {
					limit = {
						OR = {
							count_pops = {
								limit = { has_ethic = ethic_pacifist }
								count > 3
							}
							pop_percentage = {
								percentage > 0.2
								limit = { has_ethic = ethic_pacifist }
							}
						}
					}
				}
				add_modifier = {
					modifier = cc_faction_sympathies_prosperity
					days = -1
				}
			}
		}
	}
}

planet_event = {
	id = ccfaction.9994
	title = ccfaction.9994.name
	desc = ccfaction.9994.desc
	picture = GFX_evt_alien_propaganda
	
	is_triggered_only = yes
	
	option = {
		name = UNFORTUNATE
		
		tooltip = {
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = xenoist } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_xenoist
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = supremacist } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_supremacist
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = isolationist } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_isolationist
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = traditionalist } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_traditionalist
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = technologist } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_technologist
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = progressive } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_progressive
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = totalitarian } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_totalitarian
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = imperialist } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_imperialist
					days = -1
				}
			}
		
			if = {
				limit = { event_target:cc_rebellious_faction = { is_pop_faction_type = prosperity } }
				
				add_modifier = {
					modifier = cc_faction_stronghold_prosperity
					days = -1
				}
			}
		}
	}
}



