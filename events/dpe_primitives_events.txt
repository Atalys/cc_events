
namespace = dpe_primitives



#on_space_battle_won
country_event = {
	id = dpe_primitives.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		fromfrom.solar_system = {
			check_variable = {
				which = dpe_space_battle
				value > 20
			}
			NOT = {
				has_star_flag = mem_lunar_age_system
			}
			any_planet = {
				has_owner = yes
				exists = owner
				owner = {
					is_country_type = primitive
					
					NOT = { has_country_flag = dpe_has_discovered_aliens }
					NOT = { has_country_flag = dpe_has_had_lights_in_sky }
				}
				any_pop = {
					NOT = {
						has_ethic = ethic_gestalt_consciousness
					}
				}
				if = {
					limit = { has_observation_outpost = yes }
					observation_outpost = {
						NOT = {
							has_mission = covert_infiltration
						}
					}
				}
			}
		}
	}
	
	immediate = {
		fromfrom.solar_system = {
			save_event_target_as = dpe_primitive_system
			random_planet = {
				limit = {
					has_owner = yes
					exists = owner
					owner = { is_country_type = primitive }
				}
				save_event_target_as = dpe_primitive_planet
				owner = {
					save_event_target_as = dpe_primitive_civ
					set_country_flag = dpe_has_had_lights_in_sky
				}
				if = {
					limit = { has_observation_outpost = yes }
					random_list = {
						1 = {
							observation_outpost_owner = {
								country_event = { id = dpe_primitive_events.2 days = 20 }
							}
							modifier = {
								factor = 2
								solar_system = {
									check_variable = {
										which = dpe_space_battle
										value > 40
									}
								}
							}
							modifier = {
								factor = 2
								solar_system = {
									check_variable = {
										which = dpe_space_battle
										value > 60
									}
								}
							}
							modifier = {
								factor = 2
								solar_system = {
									check_variable = {
										which = dpe_space_battle
										value > 80
									}
								}
							}
							modifier = {
								factor = 2
								solar_system = {
									check_variable = {
										which = dpe_space_battle
										value > 100
									}
								}
							}
							modifier = {
								factor = 2
								solar_system = {
									check_variable = {
										which = dpe_space_battle
										value > 120
									}
								}
							}
							modifier = {
								factor = 2
								solar_system = {
									check_variable = {
										which = dpe_space_battle
										value > 150
									}
								}
							}
							modifier = {
								factor = 10
								solar_system = {
									check_variable = {
										which = dpe_space_battle
										value > 200
									}
								}
							}
						}
						2 = { #they miss it
							#set the modifiers for the level of primitiveness - low up to middle ages, but unmissable for early space age
							modifier = {
								factor = 2.5
								owner = {
									OR = {
										has_country_flag = stone_age
										has_country_flag = bronze_age
									}
								}
							}
							modifier = {
								factor = 1.5
								owner = {
									OR = {
										has_country_flag = iron_age
										has_country_flag = late_medieval_age
									}
								}
							}
							modifier = { #just so I don't lose the flags
								factor = 1
								owner = {
									OR = {
										has_country_flag = renaissance_age
										has_country_flag = steam_age
									}
								}
							}
							modifier = {
								factor = 0.75
								owner = {
									has_country_flag = machine_age
								}
							}
							modifier = {
								factor = 0.5
								owner = {
									has_country_flag = atomic_age
								}
							}
							modifier = {
								factor = 0
								owner = {
									has_country_flag = early_space_age
								}
							}
						}
					}
				}
				
				else = {
					if = {
						limit = {
							owner = {
								has_country_flag = early_space_age
							}
						}
						root = {
							country_event = { id = dpe_primitive_events.3 days = 60 random = 360 }
						}
					}
				}
			}
		}
	}
}
					
country_event = {
	id = dpe_primitives.2
	title = dpe_primitives.2.name

	desc = {
		trigger = {
			event_target:dpe_primitive_civ = {
				OR = {
					has_country_flag = stone_age
					has_country_flag = bronze_age
					has_country_flag = iron_age
				}
			}
		}
		text = dpe_primitives.2.primitive
	}
	desc = {
		trigger = {
			event_target:dpe_primitive_civ = {
				OR = {
					has_country_flag = late_medieval_age
					has_country_flag = renaissance_age
				}
			}
		}
		text = dpe_primitives.2.renaissance
	}
	desc = {
		trigger = {
			event_target:dpe_primitive_civ = {
				OR = {
					has_country_flag = steam_age
					has_country_flag = machine_age
					has_country_flag = atomic_age
				}
			}
		}
		text = dpe_primitives.2.machine
	}
	desc = {
		trigger = {
			event_target:dpe_primitive_civ = {
				has_country_flag = early_space_age
			}
		}
		text = dpe_primitives.2.space_age
	}

	is_triggered_only = yes

	picture = {
		trigger = {
			event_target:dpe_primitive_civ = {
				OR = {
					has_country_flag = stone_age
					has_country_flag = bronze_age
				}
			}
		}
		picture = GFX_evt_alien_cavemen
	}
	picture = {
		trigger = {
			event_target:dpe_primitive_civ = {
				OR = {
					has_country_flag = iron_age
					has_country_flag = late_medieval_age
					has_country_flag = renaissance_age
					has_country_flag = steam_age
				}
			}
		}
		picture = GFX_evt_medieval_alien_civilization
	}
	picture = {
		trigger = {
			event_target:dpe_primitive_civ = {
				OR = {
					has_country_flag = machine_age
					has_country_flag = atomic_age
					has_country_flag = early_space_age
				}
			}
		}
		picture = GFX_evt_news_room
	}

	immediate = {
		if = {
			limit = {
				event_target:dpe_primitive_civ = {
					has_country_flag = early_space_age
				}
			}
			country_event = { id = dpe_primitive_events.3 days = 60 random = 360 }
		}
	}

	option = {
		name = INTERESTING

		trigger = {
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
				event_target:dpe_primitive_civ = {
					has_country_flag = early_space_age
				}
			}
			NOR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
		}
	}

	option = {
		name = dpe_primitive_events.2.amusing

		trigger = {
			NOR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
				has_valid_civic = civic_machine_terminator
				has_valid_civic = civic_hive_devouring_swarm
				event_target:dpe_primitive_civ = {
					has_country_flag = early_space_age
				}
			}
		}
	}

	option = {
		name = dpe_primitive_events.2.irrelevant

		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
		}
	}

	option = {
		name = dpe_primitive_events.2.terminator

		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}

	option = {
		name = dpe_primitive_events.2.devourer

		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}
}	

#Persistent Radio Signals - primitives trigger
country_event = {
	id = dpe_primitive_events.299
	hide_window = yes

	trigger = {
		is_primitive = yes
		has_country_flag = early_space_age

		NOT = {
			has_country_flag = dpe_has_discovered_aliens
		}
		
		any_owned_pop = {
			NOT = {
				has_ethic = ethic_gestalt_consciousness
			}
		}
		capital_scope = {
			has_observation_outpost = yes

			observation_outpost_owner = {
				NOT = {
					has_country_flag = dpe_recently_discovered_by_primitives
				}
			}

			solar_system = {
				NOT = {
					has_star_flag = mem_lunar_age_system
				}
			}
		}
	}

	mean_time_to_happen = {
		years = 30
	}

	immediate = {
		set_country_flag = dpe_has_discovered_aliens

		save_event_target_as = dpe_primitive_civ
		
		capital_scope = {
			save_event_target_as = dpe_primitive_planet
			observation_outpost_owner = {
				NOT = {
					set_timed_country_flag = {
						flag = dpe_recently_discovered_by_primitives
						years = 30
					}
				}
				country_event = { id = dpe_primitive_events.3 }
			}
			solar_system = {
				save_event_target_as = dpe_primitive_system
			}
		}
	}
}


#Persistent Radio Signals - actual event
country_event = {
	id = dpe_primitive_events.3
	title = dpe_primitive_events.3.name
	desc = {
		trigger = {
			NOT = {
				has_ethic = ethic_gestalt_consciousness
			}
		}
		text = dpe_primitive_events.3.desc
	}
	desc = {
		trigger = {
			has_ethic = ethic_gestalt_consciousness
		}
		text = dpe_primitive_events.3.desc.gestalt
	}
	is_triggered_only = yes
	
	trigger = {
		Needs to check the primitives are still primitive
	}
}

country_event = {
	id = dpe_primitive_events.4
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		
	}
}
					
#other event: MTTH, much more likely to happen if you 
		
